import{f as e,u as a,h as t,j as l,bn as s,l as u,o as d,c as i,w as c,b as n,e as o,t as r,x as p,q as m,p as f,y as v,F as g,z as x,D as _,I as y,K as h,r as b,d as w,i as k,aq as C,bo as j,bp as I,bq as B,a3 as q,br as N,$ as V,au as z}from"./index.ceec0680.js";import{_ as F}from"./u-icon.0c807563.js";import{_ as L}from"./u-image.d192f048.js";import{_ as M}from"./plugin-vue_export-helper.21dcd24c.js";var A=M(e({__name:"index",setup(e){const M=a(),A=t((()=>M.cityInfo)),D=l(),E=l(),K=l(""),P=l(!1),R=s("myMap"),U=l([]),Y=l([]),$=async()=>{const{data:e}=await N({keyword:K.value,latitude:D.value,longitude:E.value});Y.value=e,H(Y.value)},G=e=>{let a=e+"m";return e>1e3&&(a=(e/1e3).toFixed(3)+"km"),a},H=e=>{e.length&&(U.value=[],e.forEach((e=>{e.status&&U.value.push({id:e.id,latitude:+e.latitude,longitude:+e.longitude,iconPath:"/bundle/static/images/map/end_point_icon.png",height:30,width:20})})))},J=e=>{"end"!=e.detail.type||"update"!=e.detail.causedBy&&"drag"!=e.detail.causedBy||R.getCenterLocation({success:async e=>{D.value=e.latitude,E.value=e.longitude,$()}}),"end"!=e.type||"update"!=e.causedBy&&"drag"!=e.causedBy||R.getCenterLocation({success:async e=>{D.value=e.latitude,E.value=e.longitude,$()}})},O=async()=>{x({title:"搜索中...",mask:!0}),await $(),P.value=!0,_()};u((()=>A.value.latitude),(e=>{e&&(D.value=A.value.latitude,E.value=A.value.longitude,$())}),{immediate:!0});return(e,a)=>{const t=h,l=b(w("u-icon"),F),s=k,u=C,x=j,_=I,N=B,R=q,$=b(w("u-image"),L);return d(),i(s,{class:"container"},{default:c((()=>[n(" 搜索框 "),o(s,{class:"flex search"},{default:c((()=>[n(" 左侧城市 "),o(s,{class:"flex search--city",onClick:a[0]||(a[0]=e=>{y({url:"/bundle/pages/city/index"})})},{default:c((()=>[o(t,{class:"mr-[15rpx]"},{default:c((()=>[r(p(m(A).cityName),1)])),_:1}),o(l,{name:"arrow-down",size:"20"})])),_:1}),n(" 右侧搜索城市 "),o(u,{type:"text",class:"flex-1 search--search",placeholder:"搜索地点",modelValue:K.value,"onUpdate:modelValue":a[1]||(a[1]=e=>K.value=e),onConfirm:O},null,8,["modelValue"])])),_:1}),n(" 地图组件 "),o(s,{class:"mt-[30rpx] mb-[30rpx] map"},{default:c((()=>[P.value?n("v-if",!0):(d(),i(N,{key:0,id:"myMap",theme:"normal",style:{width:"100%",height:"400rpx","border-radius":"20rpx",overflow:"hidden"},"show-location":"","enable-overlooking":!1,scale:13,onRegionchange:J,latitude:D.value,longitude:E.value,markers:U.value},{default:c((()=>[o(_,{class:"iconImg"},{default:c((()=>[o(x,{class:"img",src:"https://hellouniapp.dcloud.net.cn/static/location.png"})])),_:1})])),_:1},8,["latitude","longitude","markers"]))])),_:1}),o(s,{class:"address"},{default:c((()=>{var e;return[n(" 地址列表 "),(null==(e=Y.value)?void 0:e.length)?(d(),i(s,{key:0},{default:c((()=>[o(R,{"scroll-y":"true",class:"scroll-Y","show-scrollbar":!1},{default:c((()=>[(d(!0),f(g,null,v(Y.value,((e,a)=>(d(),i(s,{class:"address-item",key:a,onClick:a=>(e=>{const a=e.location.lat,t=e.location.lng,l={cityName:A.value.cityName,city_id:A.value.city_id,latitude:a,longitude:t};M.setCityInfo(l),V("choiceAddress",{latitude:a,longitude:t}),z()})(e)},{default:c((()=>[o(s,{class:"u-flex justify-between"},{default:c((()=>[o(s,{class:"u-flex"},{default:c((()=>[o(l,{name:"map"}),o(s,{class:"font-bold ml-[10rpx] w-[500rpx] truncate"},{default:c((()=>[r(p(e.title),1)])),_:2},1024)])),_:2},1024),o(s,{class:"text-[#909399] text-[24rpx]"},{default:c((()=>[r(p(G(e._distance)),1)])),_:2},1024)])),_:2},1024),o(s,{class:"text-[#909399] text-[24rpx] ml-[40rpx] mt-[10rpx] w-[500rpx] truncate"},{default:c((()=>[r(p(e.address),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):(d(),f(g,{key:1},[n(" 无地址 "),o(s,{class:"flex flex-col items-center pb-3"},{default:c((()=>[o(s,{class:"mt-[40rpx]"},{default:c((()=>[o($,{src:"/staff/assets/good.e933dba0.png",width:"290",height:"200"})])),_:1}),o(s,{class:"my-[30rpx]"},{default:c((()=>[o(t,null,{default:c((()=>[r("没有数据哦")])),_:1})])),_:1})])),_:1})],2112))]})),_:1})])),_:1})}}}),[["__scopeId","data-v-4d6377bb"]]);export{A as default};

import{o as e,c as t,n as a,a as l,b as s,i as o,v as u,r as i,d as r,w as d,e as n,f as c,u as f,g as m,h as p,j as _,k as x,s as v,l as g,m as y,p as h,q as b,t as w,x as k,F as C,y as $,z as j,A as z,B as S,C as V,D as B,E as I,G as L,H as U,I as N,J as F,K as q}from"./index.ceec0680.js";import{_ as P}from"./page-meta.7314eaca.js";import{_ as A}from"./u-image.d192f048.js";import{_ as D}from"./u-icon.0c807563.js";import{_ as E}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as G}from"./z-paging.90c0db65.js";import{_ as H}from"./u-button.aab08c00.js";import{_ as J}from"./index.18ef6f3f.js";import{_ as K}from"./index.7a520eac.js";import{P as Q}from"./index.a4984710.js";import{a as T}from"./order.30fe33ee.js";import"./u-badge.5f9f6552.js";import"./util.52efa071.js";import"./u-empty.4626c10e.js";var M=E({name:"u-loading",props:{mode:{type:String,default:"circle"},color:{type:String,default:"#c7c7c7"},size:{type:[String,Number],default:"34"},show:{type:Boolean,default:!0}},computed:{cricleStyle(){let e={};return e.width=this.size+"rpx",e.height=this.size+"rpx","circle"==this.mode&&(e.borderColor=`#e4e4e4 #e4e4e4 #e4e4e4 ${this.color?this.color:"#c7c7c7"}`),e}}},[["render",function(u,i,r,d,n,c){const f=o;return r.show?(e(),t(f,{key:0,class:a(["u-loading","circle"==r.mode?"u-loading-circle":"u-loading-flower"]),style:l([c.cricleStyle])},null,8,["class","style"])):s("v-if",!0)}],["__scopeId","data-v-53c07659"]]);var O=E({name:"u-switch",emits:["update:modelValue","input","change"],props:{value:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},size:{type:[Number,String],default:50},activeColor:{type:String,default:"#2979ff"},inactiveColor:{type:String,default:"#ffffff"},vibrateShort:{type:Boolean,default:!1},activeValue:{type:[Number,String,Boolean],default:!0},inactiveValue:{type:[Number,String,Boolean],default:!1}},data:()=>({}),computed:{valueCom(){return this.modelValue},switchStyle(){let e={};return e.fontSize=this.size+"rpx",e.backgroundColor=this.valueCom?this.activeColor:this.inactiveColor,e},loadingColor(){return this.valueCom?this.activeColor:null}},methods:{onClick(){this.disabled||this.loading||(this.vibrateShort&&u(),this.$emit("input",!this.valueCom),this.$emit("update:modelValue",!this.valueCom),this.$nextTick((()=>{this.$emit("change",this.valueCom?this.activeValue:this.inactiveValue)})))}}},[["render",function(s,u,c,f,m,p){const _=i(r("u-loading"),M),x=o;return e(),t(x,{class:a(["u-switch",[1==p.valueCom?"u-switch--on":"",c.disabled?"u-switch--disabled":""]]),onClick:p.onClick,style:l([p.switchStyle])},{default:d((()=>[n(x,{class:"u-switch__node node-class",style:l({width:s.$u.addUnit(c.size),height:s.$u.addUnit(c.size)})},{default:d((()=>[n(_,{show:c.loading,class:"u-switch__loading",size:.6*c.size,color:p.loadingColor},null,8,["show","size","color"])])),_:1},8,["style"])])),_:1},8,["class","onClick","style"])}],["__scopeId","data-v-66207448"]]);var R=E(c({__name:"index",setup(a){const u=f(),{getImageUrl:c}=f(),E=m(),M=p((()=>E.userInfo)),R=p((()=>u.config)),W=_(!1),X=_([]),Y=_({}),Z=x({data:[],meta:[]}),ee=v(null),te=async()=>{var e;E.isLogin?(null==(e=M.value)?void 0:e.is_staff)?(j({title:"位置更新中..."}),z({type:"gcj02",success:async e=>{var t;try{const a=await S({location:`${e.latitude},${e.longitude}`});if(0==a.status){let l=a.result.ad_info.city_code.substr(3,6);11e4!=l&&31e4!=l&&21e4!=l&&41e4!=l||(l*=1,l+=100);const s={province_id:l.substr(0,3)+"000",city_id:l,district_id:a.result.ad_info.adcode,address:(null==(t=a.result.address_component.street_number)?void 0:t.length)>0?a.result.address_component.street_number:a.result.address_component.street,longitude:e.longitude,latitude:e.latitude};await V(s),await m().getUser(),uni.$u.toast("位置更新成功")}else uni.$u.toast(a.message)}catch(a){uni.$u.toast(a),console.log("逆解析地址",a)}},fail(e){B()}})):uni.$u.toast("当前账号未入驻"):uni.$u.toast("请先登录")},ae=()=>{var e;return E.isLogin?(null==(e=M.value)?void 0:e.is_staff)?void I({}):(W.value=!1,void uni.$u.toast("当前账号未入驻，暂无法调整")):(W.value=!1,void uni.$u.toast("请先登录"))},le=()=>{var e;E.isLogin?(null==(e=M.value)?void 0:e.is_staff)?oe("/bundle/pages/service_time/index"):uni.$u.toast("当前账号未入驻，暂无法调整"):uni.$u.toast("请先登录")},se=async(e,t)=>{try{const{lists:a,extend:l}=await T({page_no:e,page_size:t});Y.value=l,ee.value.complete(a)}catch(a){console.log("报错=>",a),ee.value.complete(!1)}},oe=e=>{N({url:e})},ue=p((()=>{var e;const{bg_type:t,bg_color:a,bg_image:l}=null!=(e=Z.meta)?e:{};return 1==t?{"background-color":a}:{"background-image":`url(${c(l)})`}}));return g((()=>M.value),(e=>{var t;W.value=1===(null==(t=M.value)?void 0:t.work_status)}),{immediate:!0}),y((()=>{(async()=>{var e;const t=await L({id:5});Z.data=t.data,Z.meta=null==(e=t.meta[0])?void 0:e.content,U({title:Z.meta.title||"首页"})})()})),(a,u)=>{const c=i(r("page-meta"),P),f=i(r("u-image"),A),m=o,p=i(r("u-icon"),D),_=F,x=q,v=i(r("u-switch"),O),g=i(r("z-paging"),G),y=i(r("u-button"),H);return e(),h(C,null,[n(c,{"page-style":a.$theme.pageStyle},null,8,["page-style"]),(e(),t(m,{class:"container",style:l(b(ue)),key:b(ue)},{default:d((()=>[n(m,{class:"main"},{default:d((()=>[n(m,{class:"top"},{default:d((()=>[n(m,{class:"u-flex"},{default:d((()=>{var a;return[n(f,{onClick:u[0]||(u[0]=e=>oe("/pages/user_set/index")),src:(null==(a=b(M))?void 0:a.avatar)||b(R).default_avatar,width:"80",height:"80","border-radius":"40"},null,8,["src"]),n(m,{class:"ml-[20rpx] text-[#ffffff]",onClick:u[1]||(u[1]=e=>oe("/pages/user_set/index"))},{default:d((()=>{var a;return[n(m,null,{default:d((()=>{var e;return[w(k(b(E).isLogin?(null==(e=b(M))?void 0:e.name)||"未入驻":"请登录"),1)]})),_:1}),(null==(a=b(M))?void 0:a.sn)&&b(E).isLogin?(e(),t(m,{key:0,class:"text-[22rpx] text-[#c8c9cc]"},{default:d((()=>{var e;return[w("工号："+k(null==(e=b(M))?void 0:e.sn),1)]})),_:1})):s("v-if",!0)]})),_:1})]})),_:1}),n(m,{class:"u-flex justify-between items-center text-[24rpx] address mt-[20rpx]"},{default:d((()=>[n(m,{class:"flex-1 w-full"},{default:d((()=>{var e,t,a,l,s,o;return[w(" 上次位置："+k(null==(t=null==(e=b(M))?void 0:e.last_address_info)?void 0:t.city)+" "+k(null==(l=null==(a=b(M))?void 0:a.last_address_info)?void 0:l.district)+" "+k(null==(o=null==(s=b(M))?void 0:s.last_address_info)?void 0:o.address),1)]})),_:1}),n(m,{class:"u-flex items-center",onClick:te},{default:d((()=>[n(p,{name:"reload",color:a.$theme.primaryColor},null,8,["color"]),n(m,{class:"ml-[10rpx]",style:l({color:a.$theme.primaryColor})},{default:d((()=>[w("更新位置")])),_:1},8,["style"])])),_:1})])),_:1}),n(m,{class:"u-flex justify-between items-center mt-[20rpx] service-time"},{default:d((()=>[n(m,null,{default:d((()=>[s(' <u-button type="primary" size="medium" :custom-style="{\'background-color\':$theme.primaryColor}">服务时间</u-button> '),n(_,{class:"bg-primary text-lg text-white",onClick:le},{default:d((()=>[w(" 服务时间 ")])),_:1})])),_:1}),n(m,{class:"u-flex items-center"},{default:d((()=>[n(x,{class:"mr-[16rpx] text-[#ffffff]"},{default:d((()=>[w(k(W.value?"接单中":"休息中"),1)])),_:1}),n(v,{modelValue:W.value,"onUpdate:modelValue":u[2]||(u[2]=e=>W.value=e),"active-color":a.$theme.primaryColor,"inactive-color":"#e2e2e3",onChange:ae},null,8,["modelValue","active-color"])])),_:1})])),_:1})])),_:1}),n(m,{class:"lists"},{default:d((()=>[n(m,{class:"u-flex justify-between mb-[30rpx]"},{default:d((()=>[n(m,{class:"text-center time-item"},{default:d((()=>[n(m,{class:"text-[24rpx] text-muted mb-[6rpx]"},{default:d((()=>{var e;return[w("待服务："+k((null==(e=Y.value)?void 0:e.today_num)||0)+"单",1)]})),_:1}),n(m,{class:"font-bold text-1xl"},{default:d((()=>[w("今天")])),_:1})])),_:1}),n(m,{class:"text-center time-item"},{default:d((()=>[n(m,{class:"text-[24rpx] text-muted mb-[6rpx]"},{default:d((()=>{var e;return[w("待服务："+k((null==(e=Y.value)?void 0:e.tomorrow_num)||0)+"单",1)]})),_:1}),n(m,{class:"font-bold text-1xl"},{default:d((()=>[w("明天")])),_:1})])),_:1}),n(m,{class:"text-center time-item"},{default:d((()=>[n(m,{class:"text-[24rpx] text-muted mb-[6rpx]"},{default:d((()=>{var e;return[w("待服务："+k((null==(e=Y.value)?void 0:e.after_tomorrow_num)||0)+"单",1)]})),_:1}),n(m,{class:"font-bold text-1xl"},{default:d((()=>[w("后天")])),_:1})])),_:1})])),_:1}),n(m,{class:"mb-[150rpx]"},{default:d((()=>{var o;return[b(E).isLogin&&(null==(o=b(M))?void 0:o.is_staff)?(e(),t(m,{key:0},{default:d((()=>[n(g,{"auto-show-back-to-top":"",ref_key:"paging",ref:ee,modelValue:X.value,"onUpdate:modelValue":u[3]||(u[3]=e=>X.value=e),onQuery:se,fixed:!1,"use-page-scroll":!0,"use-cache":!0,"cache-key":"servicePaging","cache-mode":"always","refresher-enabled":!1},{default:d((()=>[(e(!0),h(C,null,$(X.value,(s=>(e(),t(m,{class:"lists-item",key:s.id,onClick:e=>oe(`/pages/order_detail/index?id=${s.id}`)},{default:d((()=>[n(m,{class:"u-flex justify-between"},{default:d((()=>[n(m,{class:"text-muted"},{default:d((()=>[w(k(s.order_type_desc),1)])),_:2},1024),n(m,{class:"font-bold"},{default:d((()=>[w(k(s.order_status_desc),1)])),_:2},1024)])),_:2},1024),n(m,{class:"u-flex font-bold text-4xl mt-[30rpx] mb-[30rpx]"},{default:d((()=>[n(m,null,{default:d((()=>[w(k(s.appoint_time_day),1)])),_:2},1024),n(m,{class:"text-[#2189ff] ml-[20rpx]",style:l({color:a.$theme.primaryColor})},{default:d((()=>[w(k(s.appoint_time_slot),1)])),_:2},1032,["style"])])),_:2},1024),n(m,{class:"u-flex goods"},{default:d((()=>[n(f,{src:s.order_goods[0].goods_image,width:"130",height:"130","border-radius":"14rpx"},null,8,["src"]),n(m,{class:"ml-[20rpx] w-[460rpx]"},{default:d((()=>[n(m,{class:"u-flex justify-between"},{default:d((()=>[n(m,{class:"truncate"},{default:d((()=>[w(k(s.order_goods[0].goods_name),1)])),_:2},1024),n(m,null,{default:d((()=>[n(Q,{price:s.order_goods[0].goods_price,priceFontSize:"30rpx",priceIconFontSize:"22rpx"},null,8,["price"])])),_:2},1024)])),_:2},1024),n(m,{class:"u-flex justify-between mt-[30rpx]"},{default:d((()=>[n(m,{class:"u-flex flex-wrap flex-1"},{default:d((()=>[(e(!0),h(C,null,$(s.order_goods[0].goods_sku_arr,((a,l)=>(e(),t(m,{class:"tag",key:l},{default:d((()=>[w(k(a),1)])),_:2},1024)))),128))])),_:2},1024),n(m,{class:"text-sm text-muted"},{default:d((()=>[w("x"+k(s.order_goods[0].goods_num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["modelValue"])])),_:1})):(e(),t(m,{key:1},{default:d((()=>[b(E).isLogin&&-1!==b(M).apply_status?(e(),t(m,{key:0,class:"mt-[40rpx]"},{default:d((()=>[0===b(M).apply_status?(e(),t(m,{key:0,class:"card"},{default:d((()=>[n(m,{class:"font-bold text-2xl pb-[40rpx] text-center"},{default:d((()=>[w("待审核")])),_:1}),n(m,{class:"text-muted mb-[30rpx]"},{default:d((()=>[w("感谢您对我们平台工作的支持，我们将在1～3个工作日内审核")])),_:1})])),_:1})):s("v-if",!0),2===b(M).apply_status?(e(),t(m,{key:1},{default:d((()=>[n(m,{class:"card"},{default:d((()=>[n(m,{class:"font-bold text-2xl pb-[40rpx] text-center"},{default:d((()=>[w("审核拒绝")])),_:1}),n(m,{class:"text-muted mb-[30rpx]"},{default:d((()=>[w(k(b(M).apply_remarks),1)])),_:1})])),_:1}),n(m,{class:"text-center mt-[100rpx]"},{default:d((()=>[n(y,{shape:"square",type:"primary",size:"medium","custom-style":{"background-color":a.$theme.primaryColor},onClick:u[4]||(u[4]=e=>oe("/bundle/pages/apply/index"))},{default:d((()=>[w("重新申请")])),_:1},8,["custom-style"])])),_:1})])),_:1})):s("v-if",!0)])),_:1})):(e(),t(m,{key:1},{default:d((()=>[n(K)])),_:1}))])),_:1}))]})),_:1})])),_:1})])),_:1}),s(" 底部导航栏 "),n(J)])),_:1},8,["style"]))],64)}}}),[["__scopeId","data-v-8a7d513e"]]);export{R as default};

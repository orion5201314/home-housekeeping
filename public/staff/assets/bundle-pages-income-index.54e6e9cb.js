import{a8 as e,r as t,d as a,o as s,c as l,w as r,e as n,t as i,x as o,R as d,b as u,p as h,y as c,F as m,n as _,a as f,i as y,K as p,f as g,g as D,s as x,j as b,q as k,b6 as $,I as v}from"./index.ceec0680.js";import{_ as C}from"./page-meta.7314eaca.js";import{_ as w}from"./u-icon.0c807563.js";import{_ as A}from"./u-image.d192f048.js";import{_ as T}from"./u-line.4170fb16.js";import{_ as S}from"./z-paging.90c0db65.js";import{_ as Y}from"./u-button.aab08c00.js";import{_ as M}from"./u-popup.4ec2fed5.js";import{_ as N}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as j}from"./index.7a520eac.js";import{P as B}from"./index.a4984710.js";import"./u-empty.4626c10e.js";var V=N({name:"u-calendar",emits:["update:modelValue","input","change"],props:{value:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},safeAreaInsetBottom:{type:Boolean,default:!1},maskCloseAble:{type:Boolean,default:!0},zIndex:{type:[String,Number],default:0},changeYear:{type:Boolean,default:!0},changeMonth:{type:Boolean,default:!0},mode:{type:String,default:"date"},maxYear:{type:[Number,String],default:2050},minYear:{type:[Number,String],default:1950},minDate:{type:[Number,String],default:"1950-01-01"},maxDate:{type:[Number,String],default:""},borderRadius:{type:[String,Number],default:20},monthArrowColor:{type:String,default:"#606266"},yearArrowColor:{type:String,default:"#909399"},color:{type:String,default:"#303133"},activeBgColor:{type:String,default:"#2979ff"},activeColor:{type:String,default:"#ffffff"},rangeBgColor:{type:String,default:"rgba(41,121,255,0.13)"},rangeColor:{type:String,default:"#2979ff"},startText:{type:String,default:"开始"},endText:{type:String,default:"结束"},btnType:{type:String,default:"primary"},isActiveCurrent:{type:Boolean,default:!0},isChange:{type:Boolean,default:!1},closeable:{type:Boolean,default:!0},toolTip:{type:String,default:"选择日期"},blur:{type:[Number,String],default:0}},data:()=>({popupValue:!1,weekday:1,weekdayArr:[],days:0,daysArr:[],showTitle:"",year:2020,month:0,day:0,startYear:0,startMonth:0,startDay:0,endYear:0,endMonth:0,endDay:0,today:"",activeDate:"",startDate:"",endDate:"",isStart:!0,min:null,max:null,weekDayZh:["日","一","二","三","四","五","六"]}),computed:{valueCom(){return this.modelValue},dataChange(){return`${this.mode}-${this.minDate}-${this.maxDate}`},uZIndex(){return this.zIndex?this.zIndex:this.$u.zIndex.popup}},watch:{dataChange(e){this.init()},valueCom(e,t){this.popupValue=e}},created(){this.init()},methods:{getColor(e,t){let a=1==t?"":this.color,s=e+1,l=`${this.year}-${this.month}-${s}`,r=new Date(l.replace(/\-/g,"/")).getTime(),n=this.startDate.replace(/\-/g,"/"),i=this.endDate.replace(/\-/g,"/");return this.isActiveCurrent&&this.activeDate==l||this.startDate==l||this.endDate==l?a=1==t?this.activeBgColor:this.activeColor:this.endDate&&r>new Date(n).getTime()&&r<new Date(i).getTime()&&(a=1==t?this.rangeBgColor:this.rangeColor),a},init(){let e=new Date;this.year=e.getFullYear(),this.month=e.getMonth()+1,this.day=e.getDate(),this.today=`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`,this.activeDate=this.today,this.min=this.initDate(this.minDate),this.max=this.initDate(this.maxDate||this.today),this.startDate="",this.startYear=0,this.startMonth=0,this.startDay=0,this.endYear=0,this.endMonth=0,this.endDay=0,this.endDate="",this.isStart=!0,this.changeData()},initDate(e){let t=e.split("-");return{year:Number(t[0]||1920),month:Number(t[1]||1),day:Number(t[2]||1)}},openDisAbled:function(e,t,a){let s=!0,l=`${e}/${t}/${a}`,r=`${this.min.year}/${this.min.month}/${this.min.day}`,n=`${this.max.year}/${this.max.month}/${this.max.day}`,i=new Date(l).getTime();return i>=new Date(r).getTime()&&i<=new Date(n).getTime()&&(s=!1),s},generateArray:function(e,t){return Array.from(new Array(t+1).keys()).slice(e)},formatNum:function(e){return e<10?"0"+e:e+""},getMonthDay:(e,t)=>new Date(e,t,0).getDate(),getWeekday:(e,t)=>new Date(`${e}/${t}/01 00:00:00`).getDay(),checkRange(t){let a=!1;return(t<this.minYear||t>this.maxYear)&&(e({title:"日期超出范围啦~",icon:"none"}),a=!0),a},changeMonthHandler(e){if(e){let e=this.month+1,t=e>12?this.year+1:this.year;this.checkRange(t)||(this.month=e>12?1:e,this.year=t,this.changeData())}else{let e=this.month-1,t=e<1?this.year-1:this.year;this.checkRange(t)||(this.month=e<1?12:e,this.year=t,this.changeData())}},changeYearHandler(e){let t=e?this.year+1:this.year-1;this.checkRange(t)||(this.year=t,this.changeData())},changeData(){this.days=this.getMonthDay(this.year,this.month),this.daysArr=this.generateArray(1,this.days),this.weekday=this.getWeekday(this.year,this.month),this.weekdayArr=this.generateArray(1,this.weekday),this.showTitle=`${this.year}年${this.month}月`,this.isChange&&"date"==this.mode&&this.btnFix(!0)},dateClick:function(e){if(e+=1,!this.openDisAbled(this.year,this.month,e)){this.day=e;let t=`${this.year}-${this.month}-${e}`;if("date"==this.mode)this.activeDate=t;else{let e=new Date(t.replace(/\-/g,"/")).getTime()<new Date(this.startDate.replace(/\-/g,"/")).getTime();this.isStart||e?(this.startDate=t,this.startYear=this.year,this.startMonth=this.month,this.startDay=this.day,this.endYear=0,this.endMonth=0,this.endDay=0,this.endDate="",this.activeDate="",this.isStart=!1):(this.endDate=t,this.endYear=this.year,this.endMonth=this.month,this.endDay=this.day,this.isStart=!0)}}},close(){this.$emit("input",!1),this.$emit("update:modelValue",!1)},getWeekText:e=>"星期"+["日","一","二","三","四","五","六"][(e=new Date(`${e.replace(/\-/g,"/")} 00:00:00`)).getDay()],btnFix(e){if(e||this.close(),"date"==this.mode){let e=this.activeDate.split("-"),t=this.isChange?this.year:Number(e[0]),a=this.isChange?this.month:Number(e[1]),s=this.isChange?this.day:Number(e[2]),l=this.getMonthDay(t,a),r=`${t}-${this.formatNum(a)}-${this.formatNum(s)}`,n=this.getWeekText(r),i=!1;`${t}-${a}-${s}`==this.today&&(i=!0),this.$emit("change",{year:t,month:a,day:s,days:l,result:r,week:n,isToday:i})}else{if(!this.startDate||!this.endDate)return;let e=this.formatNum(this.startMonth),t=this.formatNum(this.startDay),a=`${this.startYear}-${e}-${t}`,s=this.getWeekText(a),l=this.formatNum(this.endMonth),r=this.formatNum(this.endDay),n=`${this.endYear}-${l}-${r}`,i=this.getWeekText(n);this.$emit("change",{startYear:this.startYear,startMonth:this.startMonth,startDay:this.startDay,startDate:a,startWeek:s,endYear:this.endYear,endMonth:this.endMonth,endDay:this.endDay,endDate:n,endWeek:i})}}}},[["render",function(e,g,D,x,b,k){const $=y,v=t(a("u-icon"),w),C=p,A=t(a("u-button"),Y),T=t(a("u-popup"),M);return s(),l(T,{blur:D.blur,closeable:"",maskCloseAble:D.maskCloseAble,mode:"bottom",popup:!1,modelValue:b.popupValue,"onUpdate:modelValue":g[5]||(g[5]=e=>b.popupValue=e),length:"auto",safeAreaInsetBottom:D.safeAreaInsetBottom,onClose:k.close,"z-index":k.uZIndex,"border-radius":D.borderRadius},{default:r((()=>[n($,{class:"u-calendar"},{default:r((()=>[n($,{class:"u-calendar__header"},{default:r((()=>[e.$slots.tooltip?d(e.$slots,"tooltip",{key:1},void 0,!0):(s(),l($,{key:0,class:"u-calendar__header__text"},{default:r((()=>[i(o(D.toolTip),1)])),_:1}))])),_:3}),n($,{class:"u-calendar__action u-flex u-row-center"},{default:r((()=>[n($,{class:"u-calendar__action__icon"},{default:r((()=>[D.changeYear?(s(),l(v,{key:0,name:"arrow-left-double",color:D.yearArrowColor,onClick:g[0]||(g[0]=e=>k.changeYearHandler(0))},null,8,["color"])):u("v-if",!0)])),_:1}),n($,{class:"u-calendar__action__icon"},{default:r((()=>[D.changeMonth?(s(),l(v,{key:0,name:"arrow-left",color:D.monthArrowColor,onClick:g[1]||(g[1]=e=>k.changeMonthHandler(0))},null,8,["color"])):u("v-if",!0)])),_:1}),n($,{class:"u-calendar__action__text"},{default:r((()=>[i(o(b.showTitle),1)])),_:1}),n($,{class:"u-calendar__action__icon"},{default:r((()=>[D.changeMonth?(s(),l(v,{key:0,name:"arrow-right",color:D.monthArrowColor,onClick:g[2]||(g[2]=e=>k.changeMonthHandler(1))},null,8,["color"])):u("v-if",!0)])),_:1}),n($,{class:"u-calendar__action__icon"},{default:r((()=>[D.changeYear?(s(),l(v,{key:0,name:"arrow-right-double",color:D.yearArrowColor,onClick:g[3]||(g[3]=e=>k.changeYearHandler(1))},null,8,["color"])):u("v-if",!0)])),_:1})])),_:1}),n($,{class:"u-calendar__week-day"},{default:r((()=>[(s(!0),h(m,null,c(b.weekDayZh,((e,t)=>(s(),l($,{class:"u-calendar__week-day__text",key:t},{default:r((()=>[i(o(e),1)])),_:2},1024)))),128))])),_:1}),n($,{class:"u-calendar__content"},{default:r((()=>[u(" 前置空白部分 "),(s(!0),h(m,null,c(b.weekdayArr,((e,t)=>(s(),l($,{key:t,class:"u-calendar__content__item"})))),128)),(s(!0),h(m,null,c(b.daysArr,((e,t)=>(s(),l($,{class:_(["u-calendar__content__item",{"u-hover-class":k.openDisAbled(b.year,b.month,t+1),"u-calendar__content--start-date":"range"==D.mode&&b.startDate==`${b.year}-${b.month}-${t+1}`||"date"==D.mode,"u-calendar__content--end-date":"range"==D.mode&&b.endDate==`${b.year}-${b.month}-${t+1}`||"date"==D.mode}]),style:f({backgroundColor:k.getColor(t,1)}),key:t,onClick:e=>k.dateClick(t)},{default:r((()=>[n($,{class:"u-calendar__content__item__inner",style:f({color:k.getColor(t,2)})},{default:r((()=>[n($,null,{default:r((()=>[i(o(t+1),1)])),_:2},1024)])),_:2},1032,["style"]),"range"==D.mode&&b.startDate==`${b.year}-${b.month}-${t+1}`&&b.startDate!=b.endDate?(s(),l($,{key:0,class:"u-calendar__content__item__tips",style:f({color:D.activeColor})},{default:r((()=>[i(o(D.startText),1)])),_:1},8,["style"])):u("v-if",!0),"range"==D.mode&&b.endDate==`${b.year}-${b.month}-${t+1}`?(s(),l($,{key:1,class:"u-calendar__content__item__tips",style:f({color:D.activeColor})},{default:r((()=>[i(o(D.endText),1)])),_:1},8,["style"])):u("v-if",!0)])),_:2},1032,["class","style","onClick"])))),128)),n($,{class:"u-calendar__content__bg-month"},{default:r((()=>[i(o(b.month),1)])),_:1})])),_:1}),n($,{class:"u-calendar__bottom"},{default:r((()=>[n($,{class:"u-calendar__bottom__choose"},{default:r((()=>[n(C,null,{default:r((()=>[i(o("date"==D.mode?b.activeDate:b.startDate),1)])),_:1}),b.endDate?(s(),l(C,{key:0},{default:r((()=>[i("至"+o(b.endDate),1)])),_:1})):u("v-if",!0)])),_:1}),n($,{class:"u-calendar__bottom__btn"},{default:r((()=>[n(A,{type:D.btnType,shape:"circle",size:"default",onClick:g[4]||(g[4]=e=>k.btnFix(!1))},{default:r((()=>[i("确定")])),_:1},8,["type"])])),_:1})])),_:1})])),_:3})])),_:3},8,["blur","maskCloseAble","modelValue","safeAreaInsetBottom","onClose","z-index","border-radius","closeable"])}],["__scopeId","data-v-7314f304"]]);var I=N(g({__name:"index",setup(e){const d=D(),u=x(),_=b(!1),g=b(""),Y=b(""),M=b([]),N=b(0),I=e=>{g.value=e.startDate,Y.value=e.endDate},z=async()=>{try{const e=await $({start_time:g.value,end_time:Y.value});g.value=e.extend.startTime,Y.value=e.extend.endTime,N.value=e.extend.total_settlement_amount,u.value.complete(e.lists)}catch(e){console.log(e),u.value.complete(!1)}};return(e,D)=>{const x=t(a("page-meta"),C),b=p,$=t(a("u-icon"),w),W=y,R=t(a("u-image"),A),F=t(a("u-line"),T),H=t(a("z-paging"),S),Z=t(a("u-calendar"),V);return s(),h(m,null,[n(x,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),n(W,{class:"container"},{default:r((()=>[n(W,{class:"main"},{default:r((()=>[n(H,{ref_key:"paging",ref:u,modelValue:M.value,"onUpdate:modelValue":D[1]||(D[1]=e=>M.value=e),onQuery:z,fixed:!1,height:"100%"},{default:r((()=>[n(W,null,{default:r((()=>[n(W,{class:"text-sm u-flex justify-between mb-[30rpx]"},{default:r((()=>[n(W,{class:"u-flex",onClick:D[0]||(D[0]=e=>_.value=!0)},{default:r((()=>[(s(),l(b,{class:"mr-[10rpx]",key:g.value},{default:r((()=>[i(o(g.value)+" - "+o(Y.value),1)])),_:1})),n($,{name:"arrow-down",color:"#909399"})])),_:1}),n(W,{class:"u-flex"},{default:r((()=>[n(b,{class:"text-muted"},{default:r((()=>[i("总结算金额：")])),_:1}),n(b,{style:f({color:e.$theme.primaryColor})},{default:r((()=>[i(o(N.value)+"元",1)])),_:1},8,["style"])])),_:1})])),_:1}),k(d).isLogin?(s(),l(W,{key:0},{default:r((()=>[(s(!0),h(m,null,c(M.value,(e=>(s(),l(W,{class:"lists-item",key:e.id,onClick:t=>{return a="/pages/order_detail/index?id="+e.id,void v({url:a});var a}},{default:r((()=>[n(W,{class:"u-flex justify-between mb-[30rpx]"},{default:r((()=>[n(W,null,{default:r((()=>[i("订单编号："+o(e.sn),1)])),_:2},1024),n(W,{class:"font-bold"},{default:r((()=>[i(o(e.settlement_status_desc),1)])),_:2},1024)])),_:2},1024),n(W,{class:"u-flex goods"},{default:r((()=>[n(R,{src:e.order_goods[0].goods_image,width:"130",height:"130","border-radius":"14rpx"},null,8,["src"]),n(W,{class:"ml-[20rpx] w-[460rpx]"},{default:r((()=>[n(W,{class:"truncate"},{default:r((()=>[i(o(e.order_goods[0].goods_name),1)])),_:2},1024),n(W,{class:"u-flex flex-wrap items-center"},{default:r((()=>[(s(!0),h(m,null,c(e.order_goods[0].goods_sku_arr,((e,t)=>(s(),l(W,{class:"tag",key:t},{default:r((()=>[i(o(e),1)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024),n(W,{class:"mt-[30rpx] mb-[30rpx]"},{default:r((()=>[n(b,{class:"font-bold"},{default:r((()=>[i("服务完成时间：")])),_:1}),n(b,null,{default:r((()=>[i(o(e.finish_time||"-"),1)])),_:2},1024)])),_:2},1024),n(F,{color:"#f4f4f5"}),1===e.settlement_status?(s(),l(W,{key:0,class:"u-flex justify-between pt-[30rpx] pb-[10rpx]"},{default:r((()=>[n(W,null,{default:r((()=>[n(W,{class:"text-muted text-sm"},{default:r((()=>[i("总金额：")])),_:1}),n(W,null,{default:r((()=>[n(B,{price:e.order_amount,priceColor:"#000000"},null,8,["price"])])),_:2},1024)])),_:2},1024),n(W,null,{default:r((()=>[n(W,{class:"text-muted text-sm"},{default:r((()=>[i("结算佣金：")])),_:1}),n(W,null,{default:r((()=>[n(B,{price:e.settlement_amount},null,8,["price"])])),_:2},1024)])),_:2},1024)])),_:2},1024)):(s(),l(W,{key:1,class:"flex justify-end pt-[30rpx] pb-[10rpx]",style:{"align-items":"baseline"}},{default:r((()=>[n(W,{class:"text-muted text-sm"},{default:r((()=>[i("总金额：")])),_:1}),n(B,{price:e.order_amount,priceColor:"#000000"},null,8,["price"])])),_:2},1024))])),_:2},1032,["onClick"])))),128))])),_:1})):(s(),l(W,{key:1},{default:r((()=>[n(j)])),_:1}))])),_:1})])),_:1},8,["modelValue"])])),_:1}),n(Z,{modelValue:_.value,"onUpdate:modelValue":D[2]||(D[2]=e=>_.value=e),mode:"range",onChange:I},null,8,["modelValue"])])),_:1})],64)}}}),[["__scopeId","data-v-a03e354e"]]);export{I as default};

import{f as e,j as t,r as a,d as l,o as r,p as s,b as i,c as o,w as n,T as d,t as p,F as c,e as u,ae as x,I as f,J as m,i as b}from"./index.ceec0680.js";import{_ as y}from"./u-popup.4ec2fed5.js";import{c as h,d as g,e as _,f as k,g as v,h as w}from"./order.30fe33ee.js";import{u as C}from"./index.e6d3f860.js";import{_ as V}from"./plugin-vue_export-helper.21dcd24c.js";var I=V(e({__name:"index",props:{type:{default:"list"},orderId:{default:""},orderBtn:{default:{}}},emits:["refresh","backRefresh"],setup(e,{emit:V}){const I=e,B=t([]),j=t(!1),U=t(!1),S=async()=>{x({title:"温馨提示",content:"是否确认抢单？",success:async e=>{if(e.confirm)try{await h({id:I.orderId}),"detail"===I.type?V("refresh"):f({url:`/pages/order_detail/index?id=${I.orderId}`})}catch(t){console.log("抢单",t)}}})},$=async()=>{x({title:"温馨提示",content:"是否确认接单？",success:async e=>{if(e.confirm)try{await g({id:I.orderId}),"detail"===I.type?V("refresh"):f({url:`/pages/order_detail/index?id=${I.orderId}`})}catch(t){console.log("接单",t)}}})},F=()=>{x({title:"温馨提示",content:"是否确认已出发？",success:async e=>{if(e.confirm)try{await _({id:I.orderId}),V("refresh")}catch(t){console.log("已出发",t)}}})},P=()=>{if(!B.value)return uni.$u.toast("请上传图片");x({title:"温馨提示",content:"是否确认已到达？",success:async e=>{if(e.confirm)try{await k({id:I.orderId,image_info:B.value}),B.value=[],V("refresh")}catch(t){console.log("已到达",t)}}})},R=()=>{x({title:"温馨提示",content:"是否确认开始服务？",success:async e=>{if(e.confirm)try{await v({id:I.orderId}),V("refresh")}catch(t){console.log("开始服务",t)}}})},A=()=>{if(!B.value)return uni.$u.toast("请上传图片");x({title:"温馨提示",content:"是否确认完成服务？",success:async e=>{if(e.confirm)try{await w({id:I.orderId,image_info:B.value}),B.value=[],V("refresh")}catch(t){console.log("完成服务",t)}}})};return(t,x)=>{const f=m,h=b,g=a(l("u-popup"),y);return r(),s(c,null,[i(" 列表页按钮 "),"list"===e.type?(r(),o(h,{key:0,class:"flex"},{default:n((()=>[e.orderBtn.grab_btn?(r(),o(f,{key:0,class:"bg-primary ml-[20rpx] h-[60rpx] leading-[60rpx] text-base text-white",style:{border:"solid 1rpx #c8c9cc"},onClick:d(S,["stop"])},{default:n((()=>[p(" 立即抢单 ")])),_:1},8,["onClick"])):i("v-if",!0),e.orderBtn.receive_btn?(r(),o(f,{key:1,class:"bg-primary ml-[20rpx] h-[60rpx] leading-[60rpx] text-base text-white",style:{border:"solid 1rpx #c8c9cc"},onClick:d($,["stop"])},{default:n((()=>[p(" 立即接单 ")])),_:1},8,["onClick"])):i("v-if",!0)])),_:1})):i("v-if",!0),i(" 详情页按钮 "),"detail"===e.type?(r(),o(h,{key:1},{default:n((()=>[e.orderBtn.grab_btn?(r(),s(c,{key:0},[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:d(S,["stop"])},{default:n((()=>[p(" 立即抢单 ")])),_:1},8,["onClick"]),i(' <u-button class="h-[80rpx] leading-[80rpx]" type="primary" @click="handleGrab">立即抢单</u-button> ')],64)):i("v-if",!0),e.orderBtn.receive_btn?(r(),s(c,{key:1},[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:d($,["stop"])},{default:n((()=>[p(" 立即接单 ")])),_:1},8,["onClick"]),i(' <u-button class="h-[80rpx] leading-[80rpx]" type="primary" @click="handleReceive">立即接单</u-button> ')],64)):i("v-if",!0),e.orderBtn.setout_btn?(r(),s(c,{key:2},[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:d(F,["stop"])},{default:n((()=>[p(" 立即出发 ")])),_:1},8,["onClick"]),i(' <u-button class="h-[80rpx] leading-[80rpx]" type="primary" @click="handleSetout">立即出发</u-button> ')],64)):i("v-if",!0),e.orderBtn.arrive_btn?(r(),s(c,{key:3},[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:x[0]||(x[0]=d((e=>j.value=!0),["stop"]))},{default:n((()=>[p(" 已到达 ")])),_:1}),i(' <u-button class="h-[80rpx] leading-[80rpx]" type="primary" @click="arrivePopupShow = true">已到达</u-button> '),u(g,{modelValue:j.value,"onUpdate:modelValue":x[2]||(x[2]=e=>j.value=e),mode:"bottom","border-radius":20},{default:n((()=>[u(h,{class:"h-full",style:{position:"relative"}},{default:n((()=>[u(h,{class:"text-center py-[30rpx] text-1xl"},{default:n((()=>[p("请上传图片")])),_:1}),u(h,{class:"pl-[30rpx] mt-[20rpx] pb-[200rpx]"},{default:n((()=>[u(C,{modelValue:B.value,"onUpdate:modelValue":x[1]||(x[1]=e=>B.value=e),mutiple:!0,maxUpload:6,deletable:!0,width:200,height:200},null,8,["modelValue"])])),_:1}),u(h,{style:{position:"absolute",bottom:"60rpx"},class:"w-full px-[30rpx]"},{default:n((()=>[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:d(P,["stop"])},{default:n((()=>[p(" 已到达 ")])),_:1},8,["onClick"]),i(' <u-button class="h-[80rpx] leading-[80rpx]" type="primary" @click="handleArrive">已到达</u-button> ')])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)):i("v-if",!0),e.orderBtn.start_btn?(r(),s(c,{key:4},[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:d(R,["stop"])},{default:n((()=>[p(" 开始服务 ")])),_:1},8,["onClick"]),i(' <u-button type="primary" @click="handleStart">开始服务</u-button> ')],64)):i("v-if",!0),e.orderBtn.finish_btn?(r(),s(c,{key:5},[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:x[3]||(x[3]=d((e=>U.value=!0),["stop"]))},{default:n((()=>[p(" 服务完成 ")])),_:1}),i(' <u-button class="h-[80rpx] leading-[80rpx]" type="primary" @click="finishPopupShow = true">服务完成</u-button> '),u(g,{modelValue:U.value,"onUpdate:modelValue":x[5]||(x[5]=e=>U.value=e),mode:"bottom","border-radius":20},{default:n((()=>[u(h,{class:"h-full",style:{position:"relative"}},{default:n((()=>[u(h,{class:"text-center py-[30rpx] text-1xl"},{default:n((()=>[p("请上传图片")])),_:1}),u(h,{class:"pl-[30rpx] mt-[20rpx] pb-[200rpx]"},{default:n((()=>[u(C,{modelValue:B.value,"onUpdate:modelValue":x[4]||(x[4]=e=>B.value=e),mutiple:!0,maxUpload:6,deletable:!0,width:200,height:200},null,8,["modelValue"])])),_:1}),u(h,{style:{position:"absolute",bottom:"60rpx"},class:"w-full px-[30rpx]"},{default:n((()=>[u(f,{class:"bg-primary h-[80rpx] leading-[80rpx] text-base text-white",onClick:d(A,["stop"])},{default:n((()=>[p(" 服务完成 ")])),_:1},8,["onClick"]),i(' <u-button class="h-[80rpx] leading-[80rpx]" type="primary" @click="handleFinish">服务完成</u-button> ')])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)):i("v-if",!0)])),_:1})):i("v-if",!0)],64)}}}),[["__scopeId","data-v-d05a6938"]]);export{I as o};

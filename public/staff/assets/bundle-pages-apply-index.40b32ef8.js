import{f as e,s as l,g as a,j as t,h as u,l as d,r as o,d as s,o as i,c as n,w as r,R as m,a5 as c,q as p,b7 as f,m as _,a0 as v,B as x,a8 as g,aM as b,a1 as y,p as h,e as V,b as k,t as w,x as j,F as U,b8 as C,aO as $,aP as A,I as B,z as O,b9 as S,ab as D,i as z,K as E}from"./index.ceec0680.js";import{_ as I}from"./page-meta.7314eaca.js";import{_ as N,a as P}from"./u-select.da66d86e.js";import{_ as R}from"./u-input.39fcd58d.js";import{_ as q,a as F}from"./u-radio-group.beb42f9b.js";import{_ as J}from"./u-icon.0c807563.js";import{_ as K}from"./u-button.aab08c00.js";import{c as M,_ as G,u as H}from"./index.e6d3f860.js";import{_ as L}from"./plugin-vue_export-helper.21dcd24c.js";import"./u-line.4170fb16.js";import"./u-popup.4ec2fed5.js";import"./emitter.5b880544.js";import"./util.52efa071.js";const Q=e({__name:"file-upload",props:{modelValue:null,maxCount:{default:1},width:{default:180},height:{default:180},customBtn:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},header:{default:()=>({})},formData:{default:()=>({})},name:{default:"file"},multiple:{type:Boolean,default:!0},deletable:{type:Boolean,default:!0},withName:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:_}){const v=e,x=l(),g=a(),b=`${M.baseUrl}${M.urlPrefix}/upload/image`,y=t([]),h=u((()=>({token:g.token,version:M.version,...v.header}))),V=(e,l,a)=>{var t,u;if(e.code!==f.SUCCESS)a[l].progress=0,a[l].error=!0,uni.$u.toast(e.msg);else{const l=null==(t=e.data)?void 0:t.uri;let a=l;a=v.withName?[...v.modelValue,{url:l,name:null==(u=e.data)?void 0:u.name}]:v.maxCount<=1?l:Array.isArray(v.modelValue)?[...v.modelValue,l]:[l],_("update:modelValue",a)}},k=t(!1),w=()=>{k.value=!0},j=()=>{k.value=!1},U=e=>{if(v.maxCount<=1)_("update:modelValue","");else if(Array.isArray(v.modelValue)){const l=v.modelValue;l.splice(e,1),_("update:modelValue",l)}};return d((()=>v.modelValue),(e=>{var l;e&&!k.value&&(null==(l=x.value)||l.clear(),v.withName?(console.log(e),y.value=e.map((e=>({url:e.url})))):Array.isArray(e)?y.value=e.map((e=>({url:e}))):"string"==typeof e&&(y.value=[{url:e}]))}),{immediate:!0}),(e,l)=>{const a=o(s("u-upload"),G);return i(),n(a,c({ref_key:"uUploadRef",ref:x,"file-list":y.value,action:b},v,{header:p(h),onOnSuccess:V,onOnUploaded:j,onOnProgress:w,onOnRemove:U}),{default:r((()=>[m(e.$slots,"addBtn")])),_:3},16,["file-list","header"])}}});var T=L(e({__name:"index",setup(e){const l=a(),u=t(0),d=[{name:"基本信息"},{name:"服务技能"},{name:"个人资料"}],m=t({name:"",sex:1,age:null,identity_number:null,identity_portrait_image:null,identity_emblem_image:null,portrait_image:null,province_id:null,city_id:null,district_id:null,region:null,address:null,longitude:null,latitude:null,skill_id:"",goods_id:[],work_image:null,credentials_image:[],education:"",nation:""}),c={"background-color":"#f5f7f9","order-radius":"10rpx",padding:"5rpx 20rpx"},p=t(!1),f=t(""),M=t([]),G=t(!1),L=t(""),T=t([]),W=t(!1),X=t(""),Y=t([]),Z=e=>{"upper"==e&&(u.value=u.value>0?u.value-=1:0),"down"==e&&(u.value=u.value<d.length-1?u.value+=1:d.length-1)},ee=e=>{m.value.skill_id!==e[0].value&&(m.value.goods_id=[]),m.value.skill_id=e[0].value,f.value=e[0].label},le=()=>{m.value.skill_id?ue(`/bundle/pages/service_items/index?skill_id=${m.value.skill_id}&goods_id=${JSON.stringify(m.value.goods_id)}`):uni.$u.toast("请先选择服务技能")},ae=e=>{m.value.education=e[0].value,L.value=e[0].label},te=e=>{m.value.nation=e[0].value,X.value=e[0].label},ue=e=>{B({url:e})},de=async()=>{O({title:"请稍后..."}),await S(m.value),await l.getUser(),D({url:"/pages/index/index"})};return _((async e=>{(async()=>{const e=await C();for(const a in m.value)e[a]&&(m.value[a]=e[a]);m.value.region=m.value.province_id?e.last_address_info.province+" "+e.last_address_info.city+" "+e.last_address_info.district:null,f.value=e.skill_name,L.value=e.education_name,X.value=e.nation_name,(await $({})).forEach(((e,l)=>{M.value.push({value:e.id,label:e.name})}));const l=await A({});l.education.forEach(((e,l)=>{T.value.push({value:l,label:e})})),l.nation.forEach(((e,l)=>{Y.value.push({value:l,label:e})}))})(),v("choiceAddress",(async e=>{var l;m.value.longitude=e.longitude,m.value.latitude=e.latitude;try{const e=await x({location:`${m.value.latitude},${m.value.longitude}`});if(0==e.status){let a=e.result.ad_info.city_code.substr(3,6);11e4!=a&&31e4!=a&&21e4!=a&&41e4!=a||(a*=1,a+=100),m.value.city_id=a+"",m.value.province_id=m.value.city_id.substr(0,3)+"000",m.value.district_id=e.result.ad_info.adcode,m.value.address=(null==(l=e.result.address_component.street_number)?void 0:l.length)>0?e.result.address_component.street_number:e.result.address_component.street,m.value.region=`${e.result.ad_info.province} ${e.result.ad_info.city} ${e.result.ad_info.district}`}else g({title:e.message,icon:"none"})}catch(a){console.log("逆解析地址错误：",a)}})),v("serviceItems",(e=>{m.value.goods_id=e}))})),b((()=>{y(["choiceAddress"]),y(["serviceItems"])})),(e,l)=>{const a=o(s("page-meta"),I),t=o(s("u-steps"),N),_=z,v=o(s("u-input"),R),x=o(s("u-radio"),q),g=o(s("u-radio-group"),F),b=E,y=o(s("u-icon"),J),C=o(s("u-select"),P),$=o(s("u-button"),K);return i(),h(U,null,[V(a,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),V(_,{class:"main"},{default:r((()=>[k(" 步骤条 "),V(_,{class:"pt-[40rpx] pb-[70rpx]"},{default:r((()=>[V(t,{list:d,current:u.value,mode:"number","active-color":"#ffffff","un-active-color":"#d5d5d5"},null,8,["current"])])),_:1}),V(_,{class:"content"},{default:r((()=>[0==u.value?(i(),n(_,{key:0},{default:r((()=>[V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("姓名")])),_:1}),V(_,{class:"u-flex pt-[30rpx] pb-[40rpx]"},{default:r((()=>[V(v,{modelValue:m.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>m.value.name=e),clearable:!1,placeholder:"输入你的姓名","custom-style":c},null,8,["modelValue"]),V(g,{modelValue:m.value.sex,"onUpdate:modelValue":l[1]||(l[1]=e=>m.value.sex=e),class:"ml-[30rpx]","active-color":e.$theme.primaryColor},{default:r((()=>[V(x,{name:1},{default:r((()=>[w("先生")])),_:1}),V(x,{name:2},{default:r((()=>[w("女士")])),_:1})])),_:1},8,["modelValue","active-color"])])),_:1})])),_:1}),V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("年龄/岁")])),_:1}),V(_,{class:"pt-[30rpx] pb-[40rpx]"},{default:r((()=>[V(v,{modelValue:m.value.age,"onUpdate:modelValue":l[2]||(l[2]=e=>m.value.age=e),type:"number",clearable:!1,placeholder:"输入年龄","custom-style":c},null,8,["modelValue"])])),_:1})])),_:1}),V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("身份证号")])),_:1}),V(_,{class:"pt-[30rpx] pb-[40rpx]"},{default:r((()=>[V(v,{modelValue:m.value.identity_number,"onUpdate:modelValue":l[3]||(l[3]=e=>m.value.identity_number=e),clearable:!1,placeholder:"输入身份证号","custom-style":c},null,8,["modelValue"])])),_:1})])),_:1}),V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("身份证照片(人像面)")])),_:1}),V(_,{class:"pt-[30rpx] pb-[40rpx]"},{default:r((()=>[(i(),n(H,{modelValue:m.value.identity_portrait_image,"onUpdate:modelValue":l[4]||(l[4]=e=>m.value.identity_portrait_image=e),key:"identity_portrait_image"+m.value.identity_portrait_image,mutiple:!1,deletable:!0,width:700,height:260},null,8,["modelValue"]))])),_:1})])),_:1}),V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("身份证照片(国徽面)")])),_:1}),V(_,{class:"pt-[30rpx] pb-[40rpx]"},{default:r((()=>[(i(),n(H,{modelValue:m.value.identity_emblem_image,"onUpdate:modelValue":l[5]||(l[5]=e=>m.value.identity_emblem_image=e),key:"identity_emblem_image"+m.value.identity_emblem_image,mutiple:!1,deletable:!0,width:700,height:260},null,8,["modelValue"]))])),_:1})])),_:1}),V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("实拍照(正面免冠素颜照片)")])),_:1}),V(_,{class:"pt-[30rpx] pb-[40rpx]"},{default:r((()=>[(i(),n(H,{modelValue:m.value.portrait_image,"onUpdate:modelValue":l[6]||(l[6]=e=>m.value.portrait_image=e),key:"portrait_image"+m.value.portrait_image,mutiple:!1,deletable:!0,width:700,height:260},null,8,["modelValue"]))])),_:1})])),_:1}),V(_,{class:"padding-background u-flex justify-between mt-[40rpx] mb-[40rpx]",onClick:l[7]||(l[7]=e=>ue("/bundle/pages/location/index"))},{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("地址")])),_:1}),V(_,{class:"u-flex"},{default:r((()=>[V(b,{class:"text-muted mr-[10rpx]"},{default:r((()=>[w(j(m.value.region||"请选择地址"),1)])),_:1}),V(y,{name:"arrow-right",color:"#c8c9cc"})])),_:1})])),_:1}),V(_,{class:"padding-background mt-[40rpx] mb-[40rpx]"},{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("详细地址")])),_:1}),V(_,{class:"mt-[10rpx]"},{default:r((()=>[V(v,{modelValue:m.value.address,"onUpdate:modelValue":l[8]||(l[8]=e=>m.value.address=e),type:"textarea","auto-height":!1,clearable:!1,placeholder:"输入详细地址","custom-style":{height:"100rpx"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})):k("v-if",!0),1==u.value?(i(),n(_,{key:1},{default:r((()=>[V(_,{class:"padding-background u-flex justify-between mt-[40rpx] mb-[40rpx]",onClick:l[9]||(l[9]=e=>p.value=!0)},{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("服务技能")])),_:1}),V(_,{class:"u-flex"},{default:r((()=>[V(b,{class:"font-bold mr-[10rpx] text-muted"},{default:r((()=>[w(j(f.value),1)])),_:1}),V(y,{name:"arrow-right",color:"#c8c9cc"})])),_:1})])),_:1}),V(C,{modelValue:p.value,"onUpdate:modelValue":l[10]||(l[10]=e=>p.value=e),list:M.value,title:"服务技能",onConfirm:ee},null,8,["modelValue","list"]),V(_,{class:"padding-background u-flex justify-between mt-[40rpx] mb-[40rpx]",onClick:le},{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("服务项目")])),_:1}),V(_,{class:"u-flex"},{default:r((()=>[V(b,{class:"font-bold mr-[10rpx] text-muted"},{default:r((()=>[w(j(m.value.goods_id.length||0)+"项目",1)])),_:1}),V(y,{name:"arrow-right",color:"#c8c9cc"})])),_:1})])),_:1})])),_:1})):k("v-if",!0),2==u.value?(i(),n(_,{key:2},{default:r((()=>[V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("工装照(头像)")])),_:1}),V(_,{class:"pt-[30rpx] pb-[40rpx]"},{default:r((()=>[k(' <uploader\n\t\t\t\t\t\t\tv-model="formData.work_image"\n\t\t\t\t\t\t\t:key="\'work_image\'+formData.work_image"\n\t\t\t\t\t\t\t:mutiple="false"\n\t\t\t\t\t\t\t:deletable="true"\n\t\t\t\t\t\t\t:width="200"\n\t\t\t\t\t\t\t:height="200"\n\t\t\t\t\t\t/> '),V(Q,{modelValue:m.value.work_image,"onUpdate:modelValue":l[11]||(l[11]=e=>m.value.work_image=e),"max-count":1,width:"200",height:"200"},null,8,["modelValue"])])),_:1})])),_:1}),V(_,null,{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("证书(可上传多张)")])),_:1}),V(_,{class:"pt-[30rpx] pb-[40rpx]"},{default:r((()=>[k(' <uploader\n\t\t\t\t\t\t\tv-model="formData.credentials_image"\n\t\t\t\t\t\t\t:key="\'credentials_image\'+formData.credentials_image"\n\t\t\t\t\t\t\t:mutiple="true"\n\t\t\t\t\t\t\t:maxUpload="10"\n\t\t\t\t\t\t\t:deletable="true"\n\t\t\t\t\t\t\t:width="200"\n\t\t\t\t\t\t\t:height="200"\n\t\t\t\t\t\t/> '),V(Q,{modelValue:m.value.credentials_image,"onUpdate:modelValue":l[12]||(l[12]=e=>m.value.credentials_image=e),"max-count":10,width:"200",height:"200"},null,8,["modelValue"])])),_:1})])),_:1}),V(_,{class:"padding-background u-flex justify-between mt-[40rpx] mb-[40rpx]",onClick:l[13]||(l[13]=e=>G.value=!0)},{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("学历")])),_:1}),V(_,{class:"u-flex"},{default:r((()=>[V(b,{class:"font-bold mr-[10rpx] text-muted"},{default:r((()=>[w(j(L.value),1)])),_:1}),V(y,{name:"arrow-right",color:"#c8c9cc"})])),_:1})])),_:1}),V(C,{modelValue:G.value,"onUpdate:modelValue":l[14]||(l[14]=e=>G.value=e),list:T.value,title:"学历",onConfirm:ae},null,8,["modelValue","list"]),V(_,{class:"padding-background u-flex justify-between mt-[40rpx] mb-[40rpx]",onClick:l[15]||(l[15]=e=>W.value=!0)},{default:r((()=>[V(_,{class:"text-xl font-bold"},{default:r((()=>[w("民族")])),_:1}),V(_,{class:"u-flex"},{default:r((()=>[V(b,{class:"font-bold mr-[10rpx] text-muted"},{default:r((()=>[w(j(X.value),1)])),_:1}),V(y,{name:"arrow-right",color:"#c8c9cc"})])),_:1})])),_:1}),V(C,{modelValue:W.value,"onUpdate:modelValue":l[16]||(l[16]=e=>W.value=e),list:Y.value,title:"民族",onConfirm:te},null,8,["modelValue","list"])])),_:1})):k("v-if",!0)])),_:1})])),_:1}),k(" 底部按钮 "),V(_,{class:"footer u-flex justify-around"},{default:r((()=>[V(_,{class:"w-[200rpx] text-white text-center",onClick:l[17]||(l[17]=e=>Z("upper"))},{default:r((()=>[w("上一步")])),_:1}),k(' <u-button type="primary" size="medium" :plain="true"></u-button> '),2!==u.value?(i(),n($,{key:0,class:"custom-style",size:"medium",onClick:l[18]||(l[18]=e=>Z("down"))},{default:r((()=>[w("下一步")])),_:1})):(i(),n($,{key:1,class:"custom-style",size:"medium",onClick:de},{default:r((()=>[w("提交")])),_:1}))])),_:1})],64)}}}),[["__scopeId","data-v-501d6c78"]]);export{T as default};

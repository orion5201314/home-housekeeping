import{_ as e}from"./page-meta.31474f74.js";import{d as a,e as t,f as s,o,c as l,w as r,g as i,k as u,t as m,v as c,F as d,x as n,A as _,V as p,l as f,ao as g,i as v,m as x,D as y,q as h,s as b,R as j,j as k,W as w,b as C,X as V}from"./index-81cd8d96.js";import{t as $}from"./useTouch.dd8eee2b.js";import{t as z}from"./tabs.f4a09c96.js";import{e as N,f as S}from"./goods.c5f169af.js";import{_ as I}from"./z-paging.72de87f1.js";import{_ as L}from"./u-image.b1460259.js";import{_ as Q}from"./u-rate.781fe702.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-badge.d618a77d.js";import"./u-sticky.d243db70.js";import"./u-button.392aee34.js";import"./u-empty.d013e118.js";import"./u-icon.1e505d03.js";import"./util.4309b5a4.js";const X=T(a({__name:"card",props:{goods_id:{default:""},comment:{default:""},goods_comment_image:{default:""},reply:{default:""},create_time:{default:""},service_comment:{default:""},user:{default:{avatar:"",nickname:""}}},setup(e){const a=e;return(y,h)=>{const b=t(s("u-image"),L),j=v,k=t(s("u-rate"),Q),w=x;return o(),l(j,{class:"card"},{default:r((()=>[i(j,{class:"card--header flex justify-between col-start"},{default:r((()=>[i(j,{class:"flex"},{default:r((()=>[i(b,{src:e.user.avatar,width:"80",height:"80","border-radius":"50%"},null,8,["src"]),i(j,{class:"ml-[20rpx]"},{default:r((()=>[i(j,{class:"text-base normal font-medium"},{default:r((()=>[u(m(e.user.nickname),1)])),_:1}),i(j,{class:"text-muted text-xs mt-[10rpx]"},{default:r((()=>[u(m(e.create_time),1)])),_:1})])),_:1})])),_:1}),i(j,{class:"flex"},{default:r((()=>[i(k,{count:5,current:e.service_comment,size:"28","inactive-icon":"star-fill","active-color":y.$theme.primaryColor,disabled:!0},null,8,["current","active-color"])])),_:1})])),_:1}),i(j,{class:"card--main"},{default:r((()=>[i(j,{class:"content"},{default:r((()=>[u(m(e.comment),1)])),_:1}),i(j,{class:"flex flex-wrap"},{default:r((()=>[(o(!0),c(d,null,n(e.goods_comment_image,((e,t)=>(o(),l(j,{key:t,class:_(["mt-[10rpx]",{"mr-[10rpx]":(t+1)%4!=0}]),onClick:p((e=>{g({current:t,urls:a.goods_comment_image.map((e=>e.uri))})}),["stop"])},{default:r((()=>[i(b,{src:e.uri,width:"150",height:"150","border-radius":"14rpx"},null,8,["src"])])),_:2},1032,["class","onClick"])))),128))])),_:1}),e.reply?(o(),l(j,{key:0,class:"reply normal text-base mt-[20rpx]"},{default:r((()=>[i(w,{class:"font-medium"},{default:r((()=>[u("商家回复: ")])),_:1}),i(w,{class:"text-[#909399]"},{default:r((()=>[u(m(e.reply),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-3cccf4fa"]]),q=a({__name:"list",props:{goods_id:{default:0},i:null,index:null,cid:{default:0}},setup(e){const a=e,i=y(null),u=h([]),m=h(!0);b((()=>a.index),(async()=>{var e;await j(),a.i==a.index&&k(m)&&(m.value=!1,null==(e=i.value)||e.reload())}),{immediate:!0});const _=async(e,t)=>{try{const{lists:s}=await N({goods_id:a.goods_id,pageNo:e,pageSize:t,id:a.cid});i.value.complete(s)}catch(s){console.log("报错=>",s),i.value.complete(!1)}};return(a,m)=>{const p=t(s("z-paging"),I);return o(),l(p,{"auto-show-back-to-top":"",auto:e.i==e.index,ref_key:"paging",ref:i,modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=e=>u.value=e),"data-key":e.i,onQuery:_,fixed:!1,height:"100%"},{default:r((()=>[(o(!0),c(d,null,n(u.value,((e,a)=>(o(),l(X,{key:a,comment:e.comment,goods_comment_image:e.goods_comment_image,reply:e.reply,create_time:e.create_time,goods_id:e.goods_id,service_comment:e.service_comment,user:e.user},null,8,["comment","goods_comment_image","reply","create_time","goods_id","service_comment","user"])))),128))])),_:1},8,["auto","modelValue","data-key"])}}}),A=T(a({__name:"index",setup(a){const u=h(8),m=h([]),_=h(0),p=w(),g=C((()=>p.token)),x=e=>{_.value=Number(e)};return V((e=>{u.value=e.id||0,(async()=>{const e=await S({goods_id:u.value});m.value=[...e.comment]})()})),(a,p)=>{const y=t(s("page-meta"),e),h=v,b=t(s("tab"),$),j=t(s("tabs"),z);return o(),c(d,null,[i(y,{"page-style":a.$theme.pageStyle},null,8,["page-style"]),m.value.length?(o(),l(h,{key:0,class:"container"},{default:r((()=>[i(j,{current:_.value,onChange:x,height:"70","bar-width":"60",barStyle:{bottom:"0"},auth:!0,activeColor:a.$theme.primaryColor},{default:r((()=>[(o(!0),c(d,null,n(m.value,((e,a)=>(o(),l(b,{key:a,name:`${e.name}(${e.count})`},{default:r((()=>[k(g)?(o(),l(h,{key:0,class:"List pt-[20rpx]"},{default:r((()=>[i(q,{cid:e.id,i:a,index:_.value,goods_id:u.value},null,8,["cid","i","index","goods_id"])])),_:2},1024)):f("v-if",!0)])),_:2},1032,["name"])))),128))])),_:1},8,["current","activeColor"])])),_:1})):f("v-if",!0)],64)}}}),[["__scopeId","data-v-d38df21a"]]);export{A as default};

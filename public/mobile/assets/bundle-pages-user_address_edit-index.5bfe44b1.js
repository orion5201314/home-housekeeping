import{d as e,q as a,X as l,M as t,a_ as r,b9 as o,aB as s,a$ as d,o as u,c as i,w as c,l as n,g as m,k as p,ba as f,bb as b,ak as g,bc as _,bd as v,be as x,e as y,f as h,i as V,a8 as w}from"./index-81cd8d96.js";import{_ as $}from"./u-input.241f466f.js";import{_ as j}from"./u-form-item.bb8ca0b6.js";import{_ as k,a as U}from"./u-radio-group.e2593039.js";import{_ as q}from"./u-checkbox.5fab566c.js";import{_ as C}from"./u-form.0ab1d7c5.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.1e505d03.js";import"./emitter.1571a5d9.js";const S=M(e({__name:"index",setup(e){const M=a({contact:"",mobile:"",province:"",province_id:"",city:"",city_id:"",district:"",district_id:"",address:"",longitude:"",latitude:"",is_default:0,region:"",sex:1}),S=a(),N=a(""),A=a({contact:[{required:!0,message:"请输入联系人",trigger:["change","blur"]},{min:1,max:20,message:"输入长度不得超过20位",trigger:["blur","change"]}],mobile:[{required:!0,message:"请输入手机号码",trigger:["change","blur"]},{pattern:/^1[3-9]\d{9}$/,transform:e=>String(e),message:"请输入正确的手机号"}],region:[{required:!0,message:"请选择省市区",trigger:["change","blur"]}],address:[{required:!0,message:"请输入门牌号",trigger:["change","blur"]}]}),E=()=>{S.value.validate((e=>{if(!e)return!1;N.value?R():F()}))},F=async()=>{await b({...M.value}),setTimeout((()=>{g()}),300)},R=async()=>{await _({...M.value}),setTimeout((()=>{g()}),300)},T=()=>{v({success(e){B(e.latitude,e.longitude)},fail(e){console.log(e)}})},B=async(e,a)=>{try{const l=(await x({location:`${e},${a}`})).result;I(l)}catch(l){console.log("地址逆解析",l)}},I=e=>{let a=e.ad_info.city_code.substr(3,6);11e4!=a&&31e4!=a&&21e4!=a&&41e4!=a||(a*=1,a+=100),M.value.city_id=a+"",M.value.province_id=M.value.city_id.substr(0,3)+"000",M.value.district_id=e.ad_info.adcode,M.value.region=`${e.ad_info.province} ${e.ad_info.city} ${e.ad_info.district}`,M.value.address=e.address_component.street_number,M.value.longitude=e.location.lng,M.value.latitude=e.location.lat};return l((e=>{if(N.value=Number(e.id),e.id)t({title:"编辑地址"}),(async()=>{M.value=await f({id:N.value}),M.value.region=`${M.value.province} ${M.value.city} ${M.value.district}`})();else{t({title:"添加地址"});let e=r("wxAddress");if(!e)return;e=JSON.parse(e),M.value.contact=e.name,M.value.mobile=e.mobile,B(e.latitude,e.longitude)}})),o((()=>{var e;null==(e=S.value)||e.setRules(A.value)})),s((()=>{d("wxAddress")})),(e,a)=>{const l=y(h("u-input"),$),t=y(h("u-form-item"),j),r=y(h("u-radio"),k),o=y(h("u-radio-group"),U),s=V,d=y(h("u-checkbox"),q),f=y(h("u-form"),C),b=w;return u(),i(s,{class:"container"},{default:c((()=>[n(" Mian Start "),m(f,{model:M.value,ref_key:"formRef",ref:S,"error-type":["message","toast"],"label-position":"top","border-bottom":!1},{default:c((()=>[m(t,{prop:"region",label:"服务地址","border-bottom":!1},{default:c((()=>[m(l,{class:"bg-[#c0c4cc33] w-full",style:{"border-radius":"8rpx",padding:"8rpx 20rpx"},modelValue:M.value.region,"onUpdate:modelValue":a[0]||(a[0]=e=>M.value.region=e),placeholder:"请选择服务地址",disabled:!0,onClick:T},null,8,["modelValue"])])),_:1}),m(t,{prop:"address",label:"门牌号","border-bottom":!1},{default:c((()=>[m(l,{class:"bg-[#c0c4cc33] w-full",style:{"border-radius":"8rpx",padding:"8rpx 20rpx"},modelValue:M.value.address,"onUpdate:modelValue":a[1]||(a[1]=e=>M.value.address=e),placeholder:"请输入详细地址 例:1号楼1单元201室"},null,8,["modelValue"])])),_:1}),m(t,{prop:"contact",label:"联系人","border-bottom":!1},{default:c((()=>[m(s,{class:"u-flex"},{default:c((()=>[m(l,{class:"bg-[#c0c4cc33] w-[300rpx] mr-[40rpx]",style:{"border-radius":"8rpx",padding:"8rpx 20rpx"},modelValue:M.value.contact,"onUpdate:modelValue":a[2]||(a[2]=e=>M.value.contact=e),placeholder:"请输入联系人姓名"},null,8,["modelValue"]),m(o,{modelValue:M.value.sex,"onUpdate:modelValue":a[3]||(a[3]=e=>M.value.sex=e),"active-color":e.$theme.primaryColor},{default:c((()=>[m(r,{name:1},{default:c((()=>[p("先生")])),_:1}),m(r,{name:2},{default:c((()=>[p("女士")])),_:1})])),_:1},8,["modelValue","active-color"])])),_:1})])),_:1}),m(t,{prop:"mobile",label:"联系号码","border-bottom":!1},{default:c((()=>[m(l,{class:"bg-[#c0c4cc33] w-full",style:{"border-radius":"8rpx",padding:"8rpx 20rpx"},modelValue:M.value.mobile,"onUpdate:modelValue":a[4]||(a[4]=e=>M.value.mobile=e),placeholder:"请输入手机号码"},null,8,["modelValue"])])),_:1}),m(t,{prop:"address",label:"","border-bottom":!1},{default:c((()=>[m(s,{class:"u-flex justify-between w-full"},{default:c((()=>[m(s,null,{default:c((()=>[m(s,{class:"font-bold"},{default:c((()=>[p("设为默认地址")])),_:1}),m(s,{class:"text-sm text-muted"},{default:c((()=>[p("提示：下单时会优先使用该地址")])),_:1})])),_:1}),m(s,null,{default:c((()=>[m(d,{modelValue:M.value.is_default,"onUpdate:modelValue":a[5]||(a[5]=e=>M.value.is_default=e),shape:"circle","active-color":e.$theme.primaryColor},null,8,["modelValue","active-color"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"]),n(" Mian End "),n(" Footer Start "),m(s,{class:"fixed flex items-center justify-between bg-white footer"},{default:c((()=>[m(s,null,{default:c((()=>[m(b,{class:"bg-primary text-lg text-white leading-[80rpx] h-[80rpx]",onClick:E},{default:c((()=>[p(" 确定 ")])),_:1})])),_:1})])),_:1}),n(" Footer End ")])),_:1})}}}),[["__scopeId","data-v-95de79ec"]]);export{S as default};

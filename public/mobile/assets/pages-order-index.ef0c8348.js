import{d as e,q as t,p as r,e as a,f as s,o,c as l,w as u,g as d,k as n,t as i,l as f,v as m,F as _,x as c,n as p,r as g,V as x,P as y,i as v,m as b,D as h,s as j,I,j as k,W as w,X as C}from"./index-81cd8d96.js";import{_ as z}from"./page-meta.31474f74.js";import{_ as $}from"./u-button.392aee34.js";import{_ as V}from"./u-empty.d013e118.js";import{_ as L}from"./z-paging.72de87f1.js";import{_ as S}from"./u-image.b1460259.js";import{_ as D}from"./u-count-down.a6aaa69e.js";import{P}from"./index.d91419a7.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";import{O as B}from"./index.2afb2c5e.js";import{a as F}from"./order.8140439c.js";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang.a1320ad3.js";import{t as N}from"./useTouch.dd8eee2b.js";import{t as O}from"./tabs.f4a09c96.js";import{r as Q}from"./util.4309b5a4.js";import"./u-icon.1e505d03.js";import"./u-number-box.b3630022.js";import"./u-popup.0f1c5899.js";import"./u-input.241f466f.js";import"./emitter.1571a5d9.js";import"./goods.c5f169af.js";import"./u-badge.d618a77d.js";import"./u-sticky.d243db70.js";const U=T(e({__name:"order-card",props:{orderInfo:{default:{}}},setup(e){const h=e,j=t(0);r((()=>{const e=h.orderInfo.order_cancel_time,t=(new Date).getTime()/1e3;j.value=1e3*(e-t)}));const I=()=>{y({url:`/pages/order_detail/index?id=${h.orderInfo.id}`})};return(t,r)=>{const y=v,h=a(s("u-image"),S),k=a(s("u-count-down"),D),w=b;return o(),l(y,{class:"card",onClick:x(I,["stop"])},{default:u((()=>[d(y,{class:"u-flex justify-between"},{default:u((()=>[d(y,{class:"text-muted"},{default:u((()=>[n("上门服务")])),_:1}),d(y,null,{default:u((()=>[e.orderInfo.total_refund_amount>0?(o(),l(y,{key:0,class:"text-primary"},{default:u((()=>[n("已退款￥"+i(e.orderInfo.total_refund_amount),1)])),_:1})):(o(),l(y,{key:1},{default:u((()=>[n(i(e.orderInfo.order_status_desc),1)])),_:1}))])),_:1})])),_:1}),d(y,{class:"u-flex justify-between mt-[20rpx] mb-[30rpx]"},{default:u((()=>[d(y,{class:"font-bold text-4xl flex"},{default:u((()=>[d(y,null,{default:u((()=>[n(i(e.orderInfo.appoint_time_day),1)])),_:1}),d(y,{class:"text-primary ml-[10rpx]"},{default:u((()=>[n(i(e.orderInfo.appoint_time_slot),1)])),_:1})])),_:1}),d(y,null,{default:u((()=>[0===e.orderInfo.order_status?(o(),l(y,{key:0,class:"text-sm text-muted"},{default:u((()=>[n("该订单还没有支付")])),_:1})):f("v-if",!0),1===e.orderInfo.order_status&&0===e.orderInfo.order_sub_status?(o(),l(y,{key:1,class:"text-sm text-muted"},{default:u((()=>[n("等待服务人员接单")])),_:1})):f("v-if",!0),e.orderInfo.staff&&4!==e.orderInfo.order_status?(o(),l(y,{key:2,class:"u-flex staff",style:{"background-color":"#f7f7f7",padding:"6rpx 10rpx","border-radius":"30rpx"}},{default:u((()=>[d(h,{src:e.orderInfo.staff.work_image,width:"30",height:"30",shape:"circle"},null,8,["src"]),d(y,{class:"ml-[16rpx]"},{default:u((()=>[n(i(e.orderInfo.staff.name),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1})])),_:1}),(o(!0),m(_,null,c(e.orderInfo.order_goods,(e=>(o(),l(y,{key:e.id,class:"card--main flex"},{default:u((()=>[d(h,{src:e.goods_image,width:"130",height:"130","border-radius":"14rpx"},null,8,["src"]),d(y,{class:"ml-[20rpx] service-text w-[460rpx]"},{default:u((()=>[d(y,{class:"u-flex justify-between"},{default:u((()=>[d(y,{class:"service-text--name truncate"},{default:u((()=>[n(i(e.goods_name),1)])),_:2},1024),d(y,{class:"font-bold",style:p({color:t.$theme.primaryColor})},{default:u((()=>[n("¥"+i(e.goods_price),1)])),_:2},1032,["style"])])),_:2},1024),d(y,{class:"u-flex justify-between"},{default:u((()=>[d(y,{class:"u-flex mt-[10rpx] flex-wrap flex-1"},{default:u((()=>[(o(!0),m(_,null,c(e.goods_sku_arr,((e,t)=>(o(),l(y,{class:"tag",key:t},{default:u((()=>[n(i(e),1)])),_:2},1024)))),128))])),_:2},1024),d(y,{class:"text-muted"},{default:u((()=>[n("x"+i(e.goods_num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),d(y,{class:"card--footer flex justify-between items-center"},{default:u((()=>[d(y,{class:"u-flex"},{default:u((()=>[j.value<=0?(o(),l(P,{key:0,price:e.orderInfo.order_amount,priceFontSize:"36rpx"},null,8,["price"])):f("v-if",!0),j.value>0?(o(),l(y,{key:1,class:"primary"},{default:u((()=>[j.value>0?(o(),l(y,{key:0,class:"flex items-center"},{default:u((()=>[d(k,{timestamp:j.value,format:"mm:ss","font-size":26,"separator-size":26,onEnd:r[0]||(r[0]=e=>j.value=0)},null,8,["timestamp"]),d(w,{class:"ml-[10rpx]"},{default:u((()=>[n("后自动取消")])),_:1})])),_:1})):f("v-if",!0)])),_:1})):f("v-if",!0)])),_:1}),d(y,null,{default:u((()=>[g(t.$slots,"default",{},void 0,!0)])),_:3})])),_:3})])),_:3},8,["onClick"])}}}),[["__scopeId","data-v-41de2cf5"]]),X=e({__name:"order-list",props:{order_status:{default:0}},setup(e){const r=e,n=h(null),i=t([]);j((()=>r.order_status),(()=>{n.value.reload()}));const f=async(e,t)=>{try{const{lists:a}=await F({order_status:r.order_status,page_no:e,page_size:t});n.value.complete(a)}catch(a){console.log("报错=>",a),n.value.complete(!1)}};return I((()=>{var e;null==(e=n.value)||e.reload()})),(e,t)=>{const r=a(s("z-paging"),L);return o(),l(r,{"auto-show-back-to-top":"",ref_key:"paging",ref:n,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),onQuery:f,fixed:!1,height:"100%"},{default:u((()=>[(o(!0),m(_,null,c(i.value,((e,r)=>(o(),l(U,{key:r,orderInfo:e},{default:u((()=>[d(B,{orderId:null==e?void 0:e.id,goodsId:null==e?void 0:e.order_goods[0].goods_id,orderGoodsId:null==e?void 0:e.order_goods[0].id,orderBtn:e.user_order_btn,onRefresh:t[0]||(t[0]=e=>k(n).reload())},null,8,["orderId","goodsId","orderGoodsId","orderBtn"])])),_:2},1032,["orderInfo"])))),128))])),_:1},8,["modelValue"])}}}),q=T(e({__name:"index",setup(e){const r=w(),i=t([{name:"全部",order_status:0},{name:"待支付",order_status:1},{name:"预约中",order_status:2},{name:"服务中",order_status:3},{name:"已完成",order_status:4},{name:"已关闭",order_status:5}]),p=t(0),g=e=>{p.value=Number(e)};I((()=>{Q("selectDate")}));return C((async e=>{p.value=1*(null==e?void 0:e.type)||0,Object.keys(e).length||(p.value=0)})),(e,t)=>{const x=a(s("page-meta"),z),b=v,h=a(s("u-button"),$),j=a(s("u-empty"),V);return o(),m(_,null,[d(x,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),d(b,{class:"order-list"},{default:u((()=>[f(' <u-tabs\n            :list="tabList"\n            :bg-color="$theme.primaryColor"\n            active-color="#fff"\n            inactive-color="#fff"\n            :is-scroll="true"\n            v-model="current"\n            @change="change"\n            height="80"\n        ></u-tabs> '),d(O,{current:p.value,onChange:g,height:"80","bar-width":"60",barStyle:{bottom:"0"},auth:!0,bgColor:e.$theme.primaryColor,activeColor:"#fff",inactiveColor:"#fff"},{default:u((()=>[(o(!0),m(_,null,c(i.value,((e,t)=>(o(),l(N,{key:t,name:e.name},null,8,["name"])))),128))])),_:1},8,["current","bgColor"]),k(r).isLogin?(o(),l(b,{key:0,class:"orderList pt-[20rpx]"},{default:u((()=>[d(X,{order_status:p.value},null,8,["order_status"])])),_:1})):(o(),l(b,{key:1},{default:u((()=>[d(j,{src:"/static/images/empty/order.png",text:"您还没有登录～",mode:"data","icon-size":300,"margin-top":"300",color:"#888888"},{bottom:u((()=>[d(b,{class:"mt-4"},{default:u((()=>[d(h,{shape:"circle",onClick:t[0]||(t[0]=e=>{y({url:"/pages/login/login"})}),ripple:!0,"hair-line":!1,type:"info"},{default:u((()=>[n(" 去登录")])),_:1})])),_:1})])),_:1},8,["src"])])),_:1}))])),_:1}),f(" 底部导航栏 "),d(G)],64)}}}),[["__scopeId","data-v-a2a71c48"]]);export{q as default};

import{e,f as t,o as a,c as s,w as l,n as o,g as u,k as r,t as i,l as n,v as c,F as d,x as p,V as f,A as m,m as h,i as x,d as b,a as _,W as g,q as y,ab as v,I as w,X as k,a4 as C,af as j,aJ as S,a6 as V,aB as z,j as B,aK as I,P as A,ad as T,ay as $,ac as N,aL as U,a8 as F}from"./index-81cd8d96.js";import{_ as q}from"./page-meta.31474f74.js";import{_ as L}from"./u-navbar.681d27f2.js";import{_ as R}from"./u-sticky.d243db70.js";import{_ as W}from"./u-avatar.c01e4a72.js";import{_ as Z}from"./u-icon.1e505d03.js";import{_ as E}from"./u-popup.0f1c5899.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";const J=H({name:"u-action-sheet",emits:["update:modelValue","input","click","close"],props:{value:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},maskCloseAble:{type:Boolean,default:!0},list:{type:Array,default:()=>[]},tips:{type:Object,default:()=>({text:"",color:"",fontSize:"26"})},cancelBtn:{type:Boolean,default:!0},safeAreaInsetBottom:{type:Boolean,default:!1},borderRadius:{type:[String,Number],default:0},zIndex:{type:[String,Number],default:0},cancelText:{type:String,default:"取消"},labelName:{type:String,default:"text"},blur:{type:[Number,String],default:0}},computed:{valueCom(){return this.modelValue},tipsStyle(){let e={};return this.tips.color&&(e.color=this.tips.color),this.tips.fontSize&&(e.fontSize=this.tips.fontSize+"rpx"),e},itemStyle(){return e=>{let t={};return this.list[e].color&&(t.color=this.list[e].color),this.list[e].fontSize&&(t.fontSize=this.list[e].fontSize+"rpx"),this.list[e].disabled&&(t.color="#c0c4cc"),t}},uZIndex(){return this.zIndex?this.zIndex:this.$u.zIndex.popup}},data:()=>({popupValue:!1}),watch:{valueCom(e,t){this.popupValue=e}},methods:{close(){this.popupClose(),this.$emit("close")},popupClose(){this.$emit("input",!1),this.$emit("update:modelValue",!1)},itemClick(e){this.list[e].disabled||(this.$emit("click",e),this.$emit("input",!1),this.$emit("update:modelValue",!1))}}},[["render",function(b,_,g,y,v,w){const k=h,C=x,j=e(t("u-popup"),E);return a(),s(j,{blur:g.blur,mode:"bottom","border-radius":g.borderRadius,popup:!1,modelValue:v.popupValue,"onUpdate:modelValue":_[2]||(_[2]=e=>v.popupValue=e),maskCloseAble:g.maskCloseAble,length:"auto",safeAreaInsetBottom:g.safeAreaInsetBottom,onClose:w.popupClose,"z-index":w.uZIndex},{default:l((()=>[g.tips.text?(a(),s(C,{key:0,class:"u-tips u-border-bottom",style:o([w.tipsStyle])},{default:l((()=>[u(k,null,{default:l((()=>[r(i(g.tips.text),1)])),_:1})])),_:1},8,["style"])):n("v-if",!0),(a(!0),c(d,null,p(g.list,((e,t)=>(a(),s(C,{key:t,onTouchmove:_[0]||(_[0]=f((()=>{}),["stop","prevent"])),onClick:e=>w.itemClick(t),style:o([w.itemStyle(t)]),class:m(["u-action-sheet-item u-line-1",[t<g.list.length-1?"u-border-bottom":""]]),"hover-stay-time":150},{default:l((()=>[u(k,null,{default:l((()=>[r(i(e[g.labelName]),1)])),_:2},1024),e.subText?(a(),s(k,{key:0,class:"u-action-sheet-item__subtext u-line-1"},{default:l((()=>[r(i(e.subText),1)])),_:2},1024)):n("v-if",!0)])),_:2},1032,["onClick","style","class"])))),128)),g.cancelBtn?(a(),s(C,{key:1,class:"u-gab"})):n("v-if",!0),g.cancelBtn?(a(),s(C,{key:2,onTouchmove:_[1]||(_[1]=f((()=>{}),["stop","prevent"])),class:"u-actionsheet-cancel u-action-sheet-item","hover-class":"u-hover-class","hover-stay-time":150,onClick:w.close},{default:l((()=>[r(i(g.cancelText),1)])),_:1},8,["onClick"])):n("v-if",!0)])),_:1},8,["blur","border-radius","modelValue","maskCloseAble","safeAreaInsetBottom","onClose","z-index"])}],["__scopeId","data-v-5831dcf0"]]),K=H(b({__name:"user_set",setup(o){const p=_(),f=g(),m=y({avatar:"",nickname:"",account:"",has_auth:"",has_password:""}),h=y([{text:"修改密码"},{text:"忘记密码"}]),b=y(!0);b.value=v();const E=y(!1),H=async()=>{const e=await I();m.value=e},K=e=>{switch(e){case 0:A({url:"/pages/change_password/change_password"});break;case 1:A({url:"/pages/forget_pwd/forget_pwd"})}},M=()=>{if(!m.value.has_password)return A({url:"/pages/change_password/change_password?type=set"});E.value=!0},O=e=>{A({url:e})},P=async()=>{C({title:"请稍后..."});try{T.getUrl()}catch(e){console.log("绑定授权报错",e)}},X=()=>{$({content:"是否退出登录？",confirmColor:"#4173FF",success:({cancel:e})=>{e||(f.logout(),N({url:"/pages/login/login"}))}})};return w((()=>{H()})),k((async e=>{const{code:t}=e;if(t){C({title:"请稍后..."}),j.set("code",t);try{await S({code:t}),V(),setTimeout((()=>{history.go(-2),H()}),500)}catch(a){throw V(),setTimeout((()=>{history.go(-2)}),500),new Error(a)}}})),z((()=>{j.remove("code")})),(o,f)=>{const _=e(t("page-meta"),q),g=e(t("u-navbar"),L),y=e(t("u-sticky"),R),v=e(t("u-avatar"),W),w=x,k=e(t("u-icon"),Z),C=U,j=F,S=e(t("u-action-sheet"),J);return a(),c(d,null,[u(_,{"page-style":o.$theme.pageStyle},null,8,["page-style"]),u(w,{class:"user-set flex flex-col min-h-0 h-full"},{default:l((()=>[u(y,{"h5-nav-height":"0","bg-color":"transparent"},{default:l((()=>[u(g,{"is-back":!0,"is-fixed":!0,title:"个人设置","border-bottom":!1,"title-bold":!1,background:{background:"rgba(256,256, 256, 0)"},"title-color":"#000"},null,8,["background"])])),_:1}),u(w,{class:"flex-1 px-[30rpx]"},{default:l((()=>[u(C,{url:"/bundle/pages/user_profile/index"},{default:l((()=>[u(w,{class:"item flex bg-white rounded-[20rpx] mt-[20rpx]"},{default:l((()=>[u(v,{src:m.value.avatar,shape:"square",size:100},null,8,["src"]),u(w,{class:"ml-[20rpx] flex flex-1 justify-between items-center"},{default:l((()=>[u(w,null,{default:l((()=>[u(w,{class:"mb-[15rpx] text-xl font-medium"},{default:l((()=>[r(i(m.value.nickname),1)])),_:1}),u(w,{class:"text-content text-xs"},{default:l((()=>[r("账号："+i(m.value.account),1)])),_:1})])),_:1}),u(k,{name:"arrow-right",color:"#666"})])),_:1})])),_:1})])),_:1}),u(w,{class:"item bg-white rounded-t-[20rpx] mt-[20rpx] btn-border flex flex-1 justify-between",onClick:M},{default:l((()=>[u(w,{class:""},{default:l((()=>[r("登录密码")])),_:1}),u(k,{name:"arrow-right",color:"#666"})])),_:1}),b.value?(a(),s(w,{key:0,class:"item bg-white rounded-b-[20rpx] flex flex-1 justify-between",onClick:P},{default:l((()=>[u(w,{class:""},{default:l((()=>[r("绑定微信")])),_:1}),u(w,{class:"flex justify-between"},{default:l((()=>[u(w,{class:"text-muted mr-[20rpx]"},{default:l((()=>[r(i(m.value.has_auth?"已绑定":"未绑定"),1)])),_:1}),n(' <u-icon name="arrow-right" color="#666"></u-icon> ')])),_:1})])),_:1})):n("v-if",!0),u(w,{class:"item bg-white rounded-t-[20rpx] mt-[20rpx] btn-border flex flex-1 justify-between",onClick:f[0]||(f[0]=e=>O("/bundle/pages/service_explan/index?id=2"))},{default:l((()=>[u(w,{class:""},{default:l((()=>[r("隐私政策")])),_:1}),u(k,{name:"arrow-right",color:"#666"})])),_:1}),u(w,{class:"item bg-white btn-border flex flex-1 justify-between",onClick:f[1]||(f[1]=e=>O("/bundle/pages/service_explan/index?id=1"))},{default:l((()=>[u(w,{class:""},{default:l((()=>[r("服务协议")])),_:1}),u(k,{name:"arrow-right",color:"#666"})])),_:1}),u(w,{class:"item bg-white rounded-b-[20rpx] flex flex-1 justify-between",onClick:f[2]||(f[2]=e=>O("/pages/as_us/as_us"))},{default:l((()=>[u(w,{class:""},{default:l((()=>[r("关于我们")])),_:1}),u(w,{class:"flex justify-between"},{default:l((()=>[u(w,{class:"text-muted mr-[20rpx]"},{default:l((()=>[r(" v"+i(B(p).config.version),1)])),_:1}),u(k,{name:"arrow-right",color:"#666"})])),_:1})])),_:1})])),_:1}),u(w,{class:"bg-white p-[30rpx]",style:{"box-shadow":"0 -4rpx 48rpx 0 #1423191f"}},{default:l((()=>[u(j,{class:"bg-primary text-lg text-white",onClick:X},{default:l((()=>[r(" 退出登录 ")])),_:1}),n(' <u-button type="error" @click="logoutHandle">\n                退出登录\n            </u-button> ')])),_:1}),u(S,{list:h.value,modelValue:E.value,"onUpdate:modelValue":f[3]||(f[3]=e=>E.value=e),onClick:K,"safe-area-inset-bottom":!0},null,8,["list","modelValue"])])),_:1})],64)}}}),[["__scopeId","data-v-a4047782"]]);export{K as default};

import{d as a,a as e,E as t,q as l,bH as s,s as o,o as u,c as d,w as i,l as n,g as r,k as c,t as p,j as m,K as f,v as _,x,F as g,J as h,a4 as v,a6 as y,P as w,m as b,e as k,f as j,i as C,a9 as L,bI as M,bJ as U,bK as I,U as R,bL as V,ak as B}from"./index-81cd8d96.js";import{_ as D}from"./u-icon.1e505d03.js";import{_ as E}from"./u-image.b1460259.js";import{_ as F}from"./modal-popup.cb53cf63.js";import{_ as J}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-button.392aee34.js";import"./u-popup.0f1c5899.js";const K=J(a({__name:"index",setup(a){e();const{showLocationModal:J,errorTitle:K,errorContent:N,getLocationData:P,setLocationData:T}=t(),q=l(),z=l(),H=l(""),Q=s("myMap"),Y=l([]),A=l([]),G=async()=>{const{data:a}=await V({keyword:H.value,latitude:q.value,longitude:z.value});A.value=a,S(A.value)},O=a=>{let e=a+"m";return a>1e3&&(e=(a/1e3).toFixed(3)+"km"),e},S=a=>{a.length&&(Y.value=[],a.forEach((a=>{a.status&&Y.value.push({id:a.id,latitude:+a.latitude,longitude:+a.longitude,iconPath:"/bundle/static/images/map/end_point_icon.png",height:30,width:20})})))},W=a=>{"end"!=a.detail.type||"update"!=a.detail.causedBy&&"drag"!=a.detail.causedBy||Q.getCenterLocation({success:async a=>{q.value=a.latitude,z.value=a.longitude,G()}})},X=async()=>{v({title:"搜索中...",mask:!0}),await G(),y()};o((()=>f.latitude),(a=>{a&&(q.value=f.latitude,z.value=f.longitude,G())}),{immediate:!0});return(a,e)=>{const t=b,l=k(j("u-icon"),D),s=C,o=L,v=M,y=U,V=I,P=R,Q=k(j("u-image"),E),G=k(j("modal-popup"),F);return u(),d(s,{class:"container"},{default:i((()=>[n(" 搜索框 "),r(s,{class:"flex search"},{default:i((()=>[n(" 左侧城市 "),r(s,{class:"flex search--city",onClick:e[0]||(e[0]=a=>{w({url:"/bundle/pages/city/index"})})},{default:i((()=>[r(t,{class:"mr-[15rpx]"},{default:i((()=>[c(p(m(f).name),1)])),_:1}),r(l,{name:"arrow-down",size:"20"})])),_:1}),n(" 右侧搜索城市 "),r(o,{type:"text",class:"flex-1 search--search",placeholder:"搜索地点",modelValue:H.value,"onUpdate:modelValue":e[1]||(e[1]=a=>H.value=a),onConfirm:X},null,8,["modelValue"])])),_:1}),n(" 地图组件 "),r(s,{class:"mt-[30rpx] mb-[30rpx] map"},{default:i((()=>[r(V,{id:"myMap",theme:"normal",style:{width:"100%",height:"400rpx","border-radius":"20rpx",overflow:"hidden"},"show-location":"","enable-overlooking":!1,scale:13,onRegionchange:W,latitude:q.value,longitude:z.value,markers:Y.value},{default:i((()=>[r(y,{class:"iconImg"},{default:i((()=>[r(v,{class:"img",src:"https://hellouniapp.dcloud.net.cn/static/location.png"})])),_:1})])),_:1},8,["latitude","longitude","markers"])])),_:1}),r(s,{class:"address"},{default:i((()=>{var a;return[n(" 地址列表 "),(null==(a=A.value)?void 0:a.length)?(u(),d(s,{key:0},{default:i((()=>[r(P,{"scroll-y":"true",class:"scroll-Y","show-scrollbar":!1},{default:i((()=>[(u(!0),_(g,null,x(A.value,((a,e)=>(u(),d(s,{class:"address-item",key:e,onClick:e=>(a=>{const e=a.location.lat,t=a.location.lng,l={name:f.name,city_id:f.city_id,latitude:e,longitude:t,addressName:a.title};T(l),B()})(a)},{default:i((()=>[r(s,{class:"u-flex justify-between"},{default:i((()=>[r(s,{class:"u-flex"},{default:i((()=>[r(l,{name:"map"}),r(s,{class:"font-bold ml-[10rpx] w-[500rpx] truncate"},{default:i((()=>[c(p(a.title),1)])),_:2},1024)])),_:2},1024),r(s,{class:"text-[#909399] text-[24rpx]"},{default:i((()=>[c(p(O(a._distance)),1)])),_:2},1024)])),_:2},1024),r(s,{class:"text-[#909399] text-[24rpx] ml-[40rpx] mt-[10rpx] w-[500rpx] truncate"},{default:i((()=>[c(p(a.address),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):(u(),_(g,{key:1},[n(" 无地址 "),r(s,{class:"flex flex-col items-center pb-3"},{default:i((()=>[r(s,{class:"mt-[40rpx]"},{default:i((()=>[r(Q,{src:"/mobile/assets/good-e933dba0.png",width:"290",height:"200"})])),_:1}),r(s,{class:"my-[30rpx]"},{default:i((()=>[r(t,null,{default:i((()=>[c("没有数据哦")])),_:1})])),_:1})])),_:1})],2112))]})),_:1}),n(" 定位提示弹窗 "),r(G,{show:m(J),"onUpdate:show":e[2]||(e[2]=a=>h(J)?J.value=a:null),title:m(K),content:m(N),onRefresh:e[3]||(e[3]=()=>{})},null,8,["show","title","content"])])),_:1})}}}),[["__scopeId","data-v-f5e002d2"]]);export{K as default};

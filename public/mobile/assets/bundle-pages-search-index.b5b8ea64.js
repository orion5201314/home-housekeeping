import{d as e,aR as a,o as s,c as l,w as t,l as r,g as c,k as u,v as o,x as i,F as n,i as p,e as d,f as h,t as f,G as _,q as m,D as x,af as v,aU as g,N as w,O as y,A as k,aV as j,ay as C,Q as b}from"./index-81cd8d96.js";import{_ as z}from"./u-search.acb61175.js";import{_ as V}from"./u-icon.1e505d03.js";import{_ as L}from"./z-paging.72de87f1.js";import{_ as Q}from"./_plugin-vue_export-helper.1b428a4d.js";import{G as U}from"./index.d5127d85.js";import"./page-meta.31474f74.js";import"./u-image.b1460259.js";import"./u-button.392aee34.js";import"./index.d91419a7.js";const G=Q(e({__name:"suggest",props:{hot_search:{default:[]},his_search:{default:[]},status:{default:0}},emits:["search","clear"],setup(e,{emit:_}){const m=e,x=e=>{_("search",e)};return a((()=>{console.log("props",m.hot_search)})),(a,m)=>{const v=p,g=d(h("u-icon"),V);return s(),l(v,{class:"bg-white suggest"},{default:t((()=>[r(" 历史搜索 "),e.his_search.length?(s(),l(v,{key:0,class:"history"},{default:t((()=>[c(v,{class:"flex justify-between px-[24rpx] pb-[26rpx] pt-[26rpx]"},{default:t((()=>[c(v,{class:"text-sm text-muted"},{default:t((()=>[u("历史搜索")])),_:1}),c(v,{class:"text-xs text-muted",onClick:m[0]||(m[0]=()=>_("clear"))},{default:t((()=>[c(g,{name:"trash",color:"#c8c9cc",size:"36rpx"})])),_:1})])),_:1}),c(v,{class:"w-full px-[24rpx] flex flex-wrap"},{default:t((()=>[(s(!0),o(n,null,i(e.his_search,((e,a)=>(s(),l(v,{key:a,class:"truncate keyword",onClick:a=>x(e)},{default:t((()=>[u(f(e),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):r("v-if",!0),r(" 热门搜索 "),e.hot_search.length&&1==e.status?(s(),l(v,{key:1,class:"hot"},{default:t((()=>[c(v,{class:"pl-[24rpx] pt-[36rpx] pb-[26rpx] text-sm text-muted"},{default:t((()=>[u("热门搜索")])),_:1}),c(v,{class:"w-full px-[24rpx] flex flex-wrap"},{default:t((()=>[(s(!0),o(n,null,i(e.hot_search,((e,a)=>(s(),l(v,{key:a,class:"truncate pt-[20rpx] pb-[20rpx] pr-[20rpx] w-1/2",onClick:a=>x(e.name)},{default:t((()=>[u(f(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):r("v-if",!0)])),_:1})}}}),[["__scopeId","data-v-2b3c1510"]]),I=Q(e({__name:"index",setup(e){const a=_({hot_search:[],his_search:[],result:[],searching:!1,status:0}),o=m(""),i=x(),n=m("default"),f=m("desc"),Q=m("list"),I=e=>{o.value=e,o.value&&(a.his_search.includes(o.value)||(a.his_search.unshift(o.value),v.set(g,a.his_search))),i.value.reload(),a.searching=!0},N=e=>{"default"===e&&(f.value="desc"),"sale"!==e&&"price"!==e||(n.value!==e?f.value="desc":f.value="desc"===f.value?"asc":"desc"),n.value=e,q(1,10)},S=async()=>{(await C({title:"温馨提示",content:"是否清空历史记录？"})).confirm&&(v.set(g,""),a.his_search=[])},q=async(e,a)=>{try{const{lists:s}=await b({keyword:o.value,page_no:e,page_size:a,sort_type:n.value,sort_value:f.value});i.value.complete(s)}catch(s){console.log("报错=>",s),i.value.complete(!1)}};return(async()=>{try{const e=await j();a.hot_search=e.data,a.status=e.status}catch(e){console.log("获取热门搜索失败=>",e)}})(),a.his_search=v.get(g)||[],(e,_)=>{const m=d(h("u-search"),z),x=p,v=d(h("u-icon"),V),g=d(h("z-paging"),L);return s(),l(x,{class:"search"},{default:t((()=>[r(" 搜索框 "),c(x,{class:"px-[24rpx] py-[14rpx] bg-white"},{default:t((()=>[c(m,{modelValue:o.value,"onUpdate:modelValue":_[0]||(_[0]=e=>o.value=e),placeholder:"请输入关键词搜索",focus:!0,height:"84",onSearch:I,onCustom:I,onClear:_[1]||(_[1]=e=>a.searching=!1)},null,8,["modelValue"])])),_:1}),r(" 搜索 "),c(x,{class:"search-content"},{default:t((()=>[r("  "),w(c(G,{onSearch:I,onClear:S,hot_search:a.hot_search,his_search:a.his_search,status:a.status},null,8,["hot_search","his_search","status"]),[[y,!a.searching]]),r("  "),w(c(x,{class:"search-content-s"},{default:t((()=>[c(x,{class:"bg-white u-flex justify-around p-[20rpx] text-[#82848a]"},{default:t((()=>[c(x,{class:k({"sort-active":"default"===n.value}),onClick:_[2]||(_[2]=e=>N("default"))},{default:t((()=>[u(" 综合排序 ")])),_:1},8,["class"]),c(x,{class:k({"sort-active":"sale"===n.value}),onClick:_[3]||(_[3]=e=>N("sale"))},{default:t((()=>[u(" 销量 "),c(v,{name:"sale"===n.value?"desc"===f.value?"arrow-down-fill":"arrow-up-fill":"arrow-down-fill",color:"sale"===n.value?"#000":"#82848a",size:"18rpx"},null,8,["name","color"])])),_:1},8,["class"]),c(x,{class:k({"sort-active":"price"===n.value}),onClick:_[4]||(_[4]=e=>N("price"))},{default:t((()=>[u(" 价格 "),c(v,{name:"price"===n.value?"desc"===f.value?"arrow-down-fill":"arrow-up-fill":"arrow-down-fill",color:"price"===n.value?"#000":"#82848a",size:"18rpx"},null,8,["name","color"])])),_:1},8,["class"]),c(x,{onClick:_[5]||(_[5]=e=>"list"==Q.value?Q.value="grid":Q.value="list")},{default:t((()=>[c(v,{name:"list"===Q.value?"grid":"list-dot",color:"#82848a",size:"36rpx"},null,8,["name"])])),_:1})])),_:1}),c(g,{ref_key:"paging",ref:i,modelValue:a.result,"onUpdate:modelValue":_[6]||(_[6]=e=>a.result=e),onQuery:q,fixed:!1,height:"100%"},{default:t((()=>[c(x,{class:"px-[24rpx]"},{default:t((()=>[c(U,{goodsList:a.result,type:Q.value},null,8,["goodsList","type"])])),_:1})])),_:1},8,["modelValue"])])),_:1},512),[[y,a.searching]])])),_:1})])),_:1})}}}),[["__scopeId","data-v-948f27d9"]]);export{I as default};

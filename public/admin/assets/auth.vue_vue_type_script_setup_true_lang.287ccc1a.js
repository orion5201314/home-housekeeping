import{y as S,N,B as q,q as L,C as M}from"./element-plus.c171b4f3.js";import{a as P}from"./role.1ffe315d.js";import{m as H}from"./menu.cc1f3c64.js";import{P as I}from"./index.36fb24eb.js";import{y as O}from"./index.881dcebb.js";import{d as U,s as m,r as c,Y,o as j,c as z,T as o,K as u,a as h,n as v}from"./@vue.dfea2d30.js";const G={class:"edit-popup"},le=U({__name:"auth",emits:["success","close"],setup(J,{expose:y,emit:p}){const s=m(),f=m(),r=m(),k=c(!1),d=c(!0),_=c([]),i=c([]),a=Y({id:"",name:"",desc:"",sort:0,menu_id:[]}),C={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}]},x=()=>{H({page_type:0}).then(e=>{i.value=e.lists,_.value=O(e.lists),v(()=>{E()})})},b=()=>{var t,n;const e=(t=s.value)==null?void 0:t.getCheckedKeys(),l=(n=s.value)==null?void 0:n.getHalfCheckedKeys();return e==null||e.unshift.apply(e,l),e},E=()=>{a.menu_id.forEach(e=>{v(()=>{var l;(l=s.value)==null||l.setChecked(e,!0,!1)})})},g=e=>{const l=i.value;for(let t=0;t<l.length;t++)s.value.store.nodesMap[l[t].id].expanded=e},w=e=>{var l,t;e?(l=s.value)==null||l.setCheckedKeys(_.value.map(n=>n.id)):(t=s.value)==null||t.setCheckedKeys([])},D=async()=>{var e,l;await((e=f.value)==null?void 0:e.validate()),a.menu_id=b(),await P(a),(l=r.value)==null||l.close(),p("success")},F=()=>{p("close")},K=()=>{var e;(e=r.value)==null||e.open()},R=async e=>{for(const l in a)e[l]!=null&&e[l]!=null&&(a[l]=e[l])};return x(),y({open:K,setFormData:R}),(e,l)=>{const t=S,n=N,A=q,B=L,T=M;return j(),z("div",G,[o(I,{ref_key:"popupRef",ref:r,title:"\u5206\u914D\u6743\u9650",async:!0,width:"550px",clickModalClose:!0,onConfirm:D,onClose:F},{default:u(()=>[o(T,{class:"ls-form",ref_key:"formRef",ref:f,rules:C,model:a,"label-width":"60px"},{default:u(()=>[o(B,{class:"h-[400px] sm:h-[600px]"},{default:u(()=>[o(A,{label:"\u6743\u9650",prop:"menu_id"},{default:u(()=>[h("div",null,[o(t,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:g}),o(t,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:w}),o(t,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=V=>d.value=V),label:"\u7236\u5B50\u8054\u52A8"},null,8,["modelValue"]),h("div",null,[o(n,{ref_key:"treeRef",ref:s,data:i.value,props:{label:"name",children:"children"},"check-strictly":!d.value,"node-key":"id","default-expand-all":k.value,"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},512)])}}});export{le as _};

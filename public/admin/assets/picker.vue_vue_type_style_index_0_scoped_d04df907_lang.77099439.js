import{D as I}from"./vuedraggable.4f16510f.js";import{P as D}from"./index.36fb24eb.js";import{F as V,_ as B,a as R}from"./index.9b62355d.js";import{u as T}from"./index.881dcebb.js";import{d as k,r as a,Z as z,b as o,w as L,F as h,n as E}from"./@vue.dfea2d30.js";import{e as M}from"./@vueuse.29b489e3.js";const H=k({components:{Popup:D,Draggable:I,FileItem:V,Material:B,Preview:R},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(l,{emit:i}){const r=a(),d=a(),c=a(""),p=a(!1),t=a([]),m=a([]),n=a(!0),f=a(-1),{disabled:_,limit:s,modelValue:y}=z(l),{getImageUrl:w}=T(),x=o(()=>{switch(l.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";default:return""}}),S=o(()=>l.limit-t.value.length>0),U=o(()=>n.value?s.value==-1?null:s.value-t.value.length:1),C=M(()=>{const e=m.value.map(u=>l.excludeDomain?u.url:u.uri);n.value?t.value=[...t.value,...e]:t.value.splice(f.value,1,e.shift()),v()},1e3,!1),P=e=>{var u;_.value||(e>=0?(n.value=!1,f.value=e):n.value=!0,(u=r.value)==null||u.open())},b=e=>{m.value=e},v=()=>{const e=s.value!=1?t.value:t.value[0]||"";i("update:modelValue",e),i("change",e),g()},A=e=>{t.value.splice(e,1),v()},F=e=>{c.value=e,p.value=!0},g=()=>{E(()=>{var e;l.hiddenUpload&&(t.value=[]),(e=d.value)==null||e.clearSelect()})};return L(y,e=>{t.value=Array.isArray(e)?e:e==""?[]:[e]},{immediate:!0}),h("limit",l.limit),h("hiddenUpload",l.hiddenUpload),{popupRef:r,materialRef:d,fileList:t,tipsText:x,handleConfirm:C,meterialLimit:U,showUpload:S,showPopup:P,selectChange:b,deleteImg:A,previewUrl:c,showPreview:p,handlePreview:F,handleClose:g,getImageUrl:w}}});export{H as _};

import{n as z,A as K,Q,R as W,B as Y}from"./element-plus.c171b4f3.js";import{P as G}from"./index.e214ea88.js";import{_ as H}from"./index.20442752.js";import{f as B,z as A}from"./index.881dcebb.js";import{d as I,Y as M,b as y,w as x,o as v,c as C,a as c,T as n,K as t,R as p,u as h,U as g,a9 as S,J as U,S as X}from"./@vue.dfea2d30.js";const Z={class:"ml-[80px] pr-8"},ee={class:"flex m-4"},ae=c("div",{class:"ml-4 form-tips"},"\u6700\u591A\u652F\u63013\u4E2A\u89C4\u683C\u9879",-1),le={class:"flex p-[16px] ml-4 mt-[16px] spec-item"},te=c("div",{class:"flex-none mr-[10px]"},[c("div",{class:"mt-2"},"\u89C4\u683C\u9879"),c("div",{class:"mt-6"})],-1),se={class:"spec-item__content"},ue={class:"flex flex-wrap col-top"},oe={class:"mt-4"},ne={class:"flex pl-[10px] mb-4"},de=c("span",{class:"require-text"},"*",-1),ie=c("span",{class:"require-text"},"*",-1),fe=I({__name:"specifications",props:{modelValue:{default:{}}},setup(N){const r=N,f=M({tableData:r.modelValue.sku,selectData:[],tableDataIndex:0}),b=y(()=>!f.selectData.length),k=y(()=>r.modelValue.sku_name_list||[]);y(()=>r.modelValue.sku||[]);const T=()=>{if(r.modelValue.sku_name_list.length>=3)return B.msgError("\u6700\u591A\u6DFB\u52A03\u4E2A\u89C4\u683C\u9879");r.modelValue.sku_name_list.push({id:"",name:"",value:[{value:""}]})},J=e=>{if(r.modelValue.sku_name_list.length<=1)return B.msgError("\u81F3\u5C11\u4E00\u4E2A\u89C4\u683C\u9879");r.modelValue.sku_name_list.splice(e,1)},O=e=>{r.modelValue.sku_name_list[e].value.push({value:""})},$=(e,l)=>{r.modelValue.sku_name_list[e].value.splice(l,1)},j=(e,l)=>{var u;const a=(u=r.modelValue)==null?void 0:u.sku_name_list[e],d=a==null?void 0:a.value[l].value;(a==null?void 0:a.value.filter(D=>D.value==d&&d!=""&&d.length!=0)).length>=2&&(B.msgWarning("\u5DF2\u5B58\u5728\u76F8\u540C\u89C4\u683C\u503C"),a.value[l].value="")},L=e=>{f.selectData=e.map(l=>l.ids)},E=(e,l)=>{f.tableData.forEach(a=>{f.selectData.includes(a.ids)&&a[l]!=null&&(a[l]=e)})},w=(e,l)=>{let a=[e,l];a=a.filter(s=>s.value!==void 0);const d=A(a.map(s=>s.ids)).join(),_=A(a.map(s=>s.value));return{id:e.id?e.id:"",ids:d,value:_,sku_value_arr:_,price:e.price?e.price:"",line_price:e.line_price?e.line_price:"",duration:e.duration?e.duration:""}},P=e=>(e=JSON.parse(JSON.stringify(e)),e.reduce((l,a)=>{const d=[];for(let _=0;_<l.length;_++){a.length||d.push(w(l[_],{}));for(let s=0;s<a.length;s++)a[s].ids=s,d.push(w(l[_],a[s]))}return d},[{}])),q=()=>{const e=r.modelValue.sku_name_list,l=f.tableData,a=e.map(u=>u.value),d=P(a),_=JSON.parse(JSON.stringify(l)),s={};_.forEach(u=>{u.sku_value_arr!==void 0&&(s[u.sku_value_arr]=u)}),f.tableData=d.map(u=>s[u.sku_value_arr]?{...s[u.sku_value_arr],value:u.value,ids:u.ids}:u)};return x(()=>k.value,()=>{q()},{deep:!0,immediate:!0}),x(()=>r.modelValue.sku,e=>{f.tableData=e}),x(()=>f.tableData,e=>{r.modelValue.sku=e},{deep:!0,immediate:!0}),(e,l)=>{const a=z,d=K,_=H,s=G,u=Q,D=W,R=Y;return v(),C(g,null,[c("div",Z,[c("div",ee,[n(a,{type:"primary",disabled:h(k).length>=3,onClick:T},{default:t(()=>[p("\u6DFB\u52A0\u89C4\u683C\u9879")]),_:1},8,["disabled"]),ae]),(v(!0),C(g,null,S(h(k),(o,i)=>(v(),U(_,{key:i,onClose:m=>J(i)},{default:t(()=>[c("div",le,[te,c("div",se,[c("div",null,[n(d,{modelValue:o.name,"onUpdate:modelValue":m=>o.name=m,style:{width:"300px"},maxlength:"30","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])]),c("div",ue,[(v(!0),C(g,null,S(o.value,(m,V)=>(v(),C("div",{class:"mt-4 mr-4",key:V},[n(_,{onClose:F=>$(i,V)},{default:t(()=>[n(d,{class:"w-40",modelValue:m.value,"onUpdate:modelValue":F=>m.value=F,maxlength:"20","show-word-limit":"",onBlur:F=>j(i,V)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1032,["onClose"])]))),128)),c("div",oe,[n(a,{onClick:m=>O(i)},{default:t(()=>[p("+ \u6DFB\u52A0\u89C4\u683C\u503C")]),_:2},1032,["onClick"])])])])])]),_:2},1032,["onClose"]))),128))]),n(R,{label:"\u89C4\u683C\u660E\u7EC6",class:"mt-8"},{default:t(()=>[c("div",ne,[n(s,{class:"mr-2",disabled:h(b),onConfirm:l[0]||(l[0]=o=>E(o,"duration"))},{default:t(()=>[n(a,{disabled:h(b)},{default:t(()=>[p("\u8BBE\u7F6E\u65F6\u957F")]),_:1},8,["disabled"])]),_:1},8,["disabled"]),n(s,{class:"mr-2",disabled:h(b),onConfirm:l[1]||(l[1]=o=>E(o,"price"))},{default:t(()=>[n(a,{disabled:h(b)},{default:t(()=>[p("\u8BBE\u7F6E\u4EF7\u683C")]),_:1},8,["disabled"])]),_:1},8,["disabled"]),n(s,{class:"mr-2",disabled:h(b),onConfirm:l[2]||(l[2]=o=>E(o,"line_price"))},{default:t(()=>[n(a,{disabled:h(b)},{default:t(()=>[p("\u8BBE\u7F6E\u5212\u7EBF\u4EF7")]),_:1},8,["disabled"])]),_:1},8,["disabled"])]),n(D,{class:"pl-[10px]",data:f.tableData,"max-height":"600","row-height":75,"tooltip-effect":"dark",border:!1,"big-data-checkbox":"",onSelectionChange:L},{default:t(()=>[n(u,{type:"selection",width:"55"}),(v(!0),C(g,null,S(h(k),(o,i)=>(v(),U(u,{key:i,label:o.name,"min-width":"140","show-overflow-tooltip":!0},{default:t(({row:m})=>{var V;return[p(X((V=m==null?void 0:m.sku_value_arr)!=null&&V.length?m==null?void 0:m.sku_value_arr[i]:""),1)]}),_:2},1032,["label"]))),128)),n(u,{"min-width":"100"},{header:t(()=>[de,p(" \u65F6\u957F ")]),default:t(({row:o})=>[n(d,{modelValue:o.duration,"onUpdate:modelValue":i=>o.duration=i,type:"number",class:"spec-input"},{append:t(()=>[p("\u5206\u949F")]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),n(u,{"min-width":"100"},{header:t(()=>[ie,p(" \u4EF7\u683C ")]),default:t(({row:o})=>[n(d,{modelValue:o.price,"onUpdate:modelValue":i=>o.price=i,type:"number",class:"spec-input"},{append:t(()=>[p("\u5143")]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),n(u,{"min-width":"100"},{header:t(()=>[p(" \u5212\u7EBF\u4EF7 ")]),default:t(({row:o})=>[n(d,{modelValue:o.line_price,"onUpdate:modelValue":i=>o.line_price=i,type:"number",class:"spec-input"},{append:t(()=>[p("\u5143")]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1})],64)}}});export{fe as _};
